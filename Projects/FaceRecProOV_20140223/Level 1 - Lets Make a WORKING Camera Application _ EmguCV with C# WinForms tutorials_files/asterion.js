var swfobject=function(){var b="undefined",Q="object",n="Shockwave Flash",p="ShockwaveFlash.ShockwaveFlash",P="application/x-shockwave-flash",m="SWFObjectExprInst",j=window,K=document,T=navigator,o=[],N=[],i=[],d=[],J,Z=null,M=null,l=null,e=false,A=false;var h=function(){var v=typeof K.getElementById!=b&&typeof K.getElementsByTagName!=b&&typeof K.createElement!=b,AC=[0,0,0],x=null;if(typeof T.plugins!=b&&typeof T.plugins[n]==Q){x=T.plugins[n].description;if(x&&!(typeof T.mimeTypes!=b&&T.mimeTypes[P]&&!T.mimeTypes[P].enabledPlugin)){x=x.replace(/^.*\s+(\S+\s+\S+$)/,"$1");AC[0]=parseInt(x.replace(/^(.*)\..*$/,"$1"),10);AC[1]=parseInt(x.replace(/^.*\.(.*)\s.*$/,"$1"),10);AC[2]=/r/.test(x)?parseInt(x.replace(/^.*r(.*)$/,"$1"),10):0}}else{if(typeof j.ActiveXObject!=b){var y=null,AB=false;try{y=new ActiveXObject(p+".7")}catch(t){try{y=new ActiveXObject(p+".6");AC=[6,0,21];y.AllowScriptAccess="always"}catch(t){if(AC[0]==6){AB=true}}if(!AB){try{y=new ActiveXObject(p)}catch(t){}}}if(!AB&&y){try{x=y.GetVariable("$version");if(x){x=x.split(" ")[1].split(",");AC=[parseInt(x[0],10),parseInt(x[1],10),parseInt(x[2],10)]}}catch(t){}}}}var AD=T.userAgent.toLowerCase(),r=T.platform.toLowerCase(),AA=/webkit/.test(AD)?parseFloat(AD.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,q=false,z=r?/win/.test(r):/win/.test(AD),w=r?/mac/.test(r):/mac/.test(AD);/*@cc_on q=true;@if(@_win32)z=true;@elif(@_mac)w=true;@end@*/return{w3cdom:v,pv:AC,webkit:AA,ie:q,win:z,mac:w}}();var L=function(){if(!h.w3cdom){return }f(H);if(h.ie&&h.win){try{K.write("<script id=__ie_ondomload defer=true src=//:><\/script>");J=C("__ie_ondomload");if(J){I(J,"onreadystatechange",S)}}catch(q){}}if(h.webkit&&typeof K.readyState!=b){Z=setInterval(function(){if(/loaded|complete/.test(K.readyState)){E()}},10)}if(typeof K.addEventListener!=b){K.addEventListener("DOMContentLoaded",E,null)}R(E)}();function S(){if(J.readyState=="complete"){J.parentNode.removeChild(J);E()}}function E(){if(e){return }if(h.ie&&h.win){var v=a("span");try{var u=K.getElementsByTagName("body")[0].appendChild(v);u.parentNode.removeChild(u)}catch(w){return }}e=true;if(Z){clearInterval(Z);Z=null}var q=o.length;for(var r=0;r<q;r++){o[r]()}}function f(q){if(e){q()}else{o[o.length]=q}}function R(r){if(typeof j.addEventListener!=b){j.addEventListener("load",r,false)}else{if(typeof K.addEventListener!=b){K.addEventListener("load",r,false)}else{if(typeof j.attachEvent!=b){I(j,"onload",r)}else{if(typeof j.onload=="function"){var q=j.onload;j.onload=function(){q();r()}}else{j.onload=r}}}}}function H(){var t=N.length;for(var q=0;q<t;q++){var u=N[q].id;if(h.pv[0]>0){var r=C(u);if(r){N[q].width=r.getAttribute("width")?r.getAttribute("width"):"0";N[q].height=r.getAttribute("height")?r.getAttribute("height"):"0";if(c(N[q].swfVersion)){if(h.webkit&&h.webkit<312){Y(r)}W(u,true)}else{if(N[q].expressInstall&&!A&&c("6.0.65")&&(h.win||h.mac)){k(N[q])}else{O(r)}}}}else{W(u,true)}}}function Y(t){var q=t.getElementsByTagName(Q)[0];if(q){var w=a("embed"),y=q.attributes;if(y){var v=y.length;for(var u=0;u<v;u++){if(y[u].nodeName=="DATA"){w.setAttribute("src",y[u].nodeValue)}else{w.setAttribute(y[u].nodeName,y[u].nodeValue)}}}var x=q.childNodes;if(x){var z=x.length;for(var r=0;r<z;r++){if(x[r].nodeType==1&&x[r].nodeName=="PARAM"){w.setAttribute(x[r].getAttribute("name"),x[r].getAttribute("value"))}}}t.parentNode.replaceChild(w,t)}}function k(w){A=true;var u=C(w.id);if(u){if(w.altContentId){var y=C(w.altContentId);if(y){M=y;l=w.altContentId}}else{M=G(u)}if(!(/%$/.test(w.width))&&parseInt(w.width,10)<310){w.width="310"}if(!(/%$/.test(w.height))&&parseInt(w.height,10)<137){w.height="137"}K.title=K.title.slice(0,47)+" - Flash Player Installation";var z=h.ie&&h.win?"ActiveX":"PlugIn",q=K.title,r="MMredirectURL="+j.location+"&MMplayerType="+z+"&MMdoctitle="+q,x=w.id;if(h.ie&&h.win&&u.readyState!=4){var t=a("div");x+="SWFObjectNew";t.setAttribute("id",x);u.parentNode.insertBefore(t,u);u.style.display="none";var v=function(){u.parentNode.removeChild(u)};I(j,"onload",v)}U({data:w.expressInstall,id:m,width:w.width,height:w.height},{flashvars:r},x)}}function O(t){if(h.ie&&h.win&&t.readyState!=4){var r=a("div");t.parentNode.insertBefore(r,t);r.parentNode.replaceChild(G(t),r);t.style.display="none";var q=function(){t.parentNode.removeChild(t)};I(j,"onload",q)}else{t.parentNode.replaceChild(G(t),t)}}function G(v){var u=a("div");if(h.win&&h.ie){u.innerHTML=v.innerHTML}else{var r=v.getElementsByTagName(Q)[0];if(r){var w=r.childNodes;if(w){var q=w.length;for(var t=0;t<q;t++){if(!(w[t].nodeType==1&&w[t].nodeName=="PARAM")&&!(w[t].nodeType==8)){u.appendChild(w[t].cloneNode(true))}}}}}return u}function U(AG,AE,t){var q,v=C(t);if(v){if(typeof AG.id==b){AG.id=t}if(h.ie&&h.win){var AF="";for(var AB in AG){if(AG[AB]!=Object.prototype[AB]){if(AB.toLowerCase()=="data"){AE.movie=AG[AB]}else{if(AB.toLowerCase()=="styleclass"){AF+=' class="'+AG[AB]+'"'}else{if(AB.toLowerCase()!="classid"){AF+=" "+AB+'="'+AG[AB]+'"'}}}}}var AD="";for(var AA in AE){if(AE[AA]!=Object.prototype[AA]){AD+='<param name="'+AA+'" value="'+AE[AA]+'" />'}}v.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+AF+">"+AD+"</object>";i[i.length]=AG.id;q=C(AG.id)}else{if(h.webkit&&h.webkit<312){var AC=a("embed");AC.setAttribute("type",P);for(var z in AG){if(AG[z]!=Object.prototype[z]){if(z.toLowerCase()=="data"){AC.setAttribute("src",AG[z])}else{if(z.toLowerCase()=="styleclass"){AC.setAttribute("class",AG[z])}else{if(z.toLowerCase()!="classid"){AC.setAttribute(z,AG[z])}}}}}for(var y in AE){if(AE[y]!=Object.prototype[y]){if(y.toLowerCase()!="movie"){AC.setAttribute(y,AE[y])}}}v.parentNode.replaceChild(AC,v);q=AC}else{var u=a(Q);u.setAttribute("type",P);for(var x in AG){if(AG[x]!=Object.prototype[x]){if(x.toLowerCase()=="styleclass"){u.setAttribute("class",AG[x])}else{if(x.toLowerCase()!="classid"){u.setAttribute(x,AG[x])}}}}for(var w in AE){if(AE[w]!=Object.prototype[w]&&w.toLowerCase()!="movie"){F(u,w,AE[w])}}v.parentNode.replaceChild(u,v);q=u}}}return q}function F(t,q,r){var u=a("param");u.setAttribute("name",q);u.setAttribute("value",r);t.appendChild(u)}function X(r){var q=C(r);if(q&&(q.nodeName=="OBJECT"||q.nodeName=="EMBED")){if(h.ie&&h.win){if(q.readyState==4){B(r)}else{j.attachEvent("onload",function(){B(r)})}}else{q.parentNode.removeChild(q)}}}function B(t){var r=C(t);if(r){for(var q in r){if(typeof r[q]=="function"){r[q]=null}}r.parentNode.removeChild(r)}}function C(t){var q=null;try{q=K.getElementById(t)}catch(r){}return q}function a(q){return K.createElement(q)}function I(t,q,r){t.attachEvent(q,r);d[d.length]=[t,q,r]}function c(t){var r=h.pv,q=t.split(".");q[0]=parseInt(q[0],10);q[1]=parseInt(q[1],10)||0;q[2]=parseInt(q[2],10)||0;return(r[0]>q[0]||(r[0]==q[0]&&r[1]>q[1])||(r[0]==q[0]&&r[1]==q[1]&&r[2]>=q[2]))?true:false}function V(v,r){if(h.ie&&h.mac){return }var u=K.getElementsByTagName("head")[0],t=a("style");t.setAttribute("type","text/css");t.setAttribute("media","screen");if(!(h.ie&&h.win)&&typeof K.createTextNode!=b){t.appendChild(K.createTextNode(v+" {"+r+"}"))}u.appendChild(t);if(h.ie&&h.win&&typeof K.styleSheets!=b&&K.styleSheets.length>0){var q=K.styleSheets[K.styleSheets.length-1];if(typeof q.addRule==Q){q.addRule(v,r)}}}function W(t,q){var r=q?"visible":"hidden";if(e&&C(t)){C(t).style.visibility=r}else{V("#"+t,"visibility:"+r)}}function g(s){var r=/[\\\"<>\.;]/;var q=r.exec(s)!=null;return q?encodeURIComponent(s):s}var D=function(){if(h.ie&&h.win){window.attachEvent("onunload",function(){var w=d.length;for(var v=0;v<w;v++){d[v][0].detachEvent(d[v][1],d[v][2])}var t=i.length;for(var u=0;u<t;u++){X(i[u])}for(var r in h){h[r]=null}h=null;for(var q in swfobject){swfobject[q]=null}swfobject=null})}}();return{registerObject:function(u,q,t){if(!h.w3cdom||!u||!q){return }var r={};r.id=u;r.swfVersion=q;r.expressInstall=t?t:false;N[N.length]=r;W(u,false)},getObjectById:function(v){var q=null;if(h.w3cdom){var t=C(v);if(t){var u=t.getElementsByTagName(Q)[0];if(!u||(u&&typeof t.SetVariable!=b)){q=t}else{if(typeof u.SetVariable!=b){q=u}}}}return q},embedSWF:function(x,AE,AB,AD,q,w,r,z,AC){if(!h.w3cdom||!x||!AE||!AB||!AD||!q){return }AB+="";AD+="";if(c(q)){W(AE,false);var AA={};if(AC&&typeof AC===Q){for(var v in AC){if(AC[v]!=Object.prototype[v]){AA[v]=AC[v]}}}AA.data=x;AA.width=AB;AA.height=AD;var y={};if(z&&typeof z===Q){for(var u in z){if(z[u]!=Object.prototype[u]){y[u]=z[u]}}}if(r&&typeof r===Q){for(var t in r){if(r[t]!=Object.prototype[t]){if(typeof y.flashvars!=b){y.flashvars+="&"+t+"="+r[t]}else{y.flashvars=t+"="+r[t]}}}}f(function(){U(AA,y,AE);if(AA.id==AE){W(AE,true)}})}else{if(w&&!A&&c("6.0.65")&&(h.win||h.mac)){A=true;W(AE,false);f(function(){var AF={};AF.id=AF.altContentId=AE;AF.width=AB;AF.height=AD;AF.expressInstall=w;k(AF)})}}},getFlashPlayerVersion:function(){return{major:h.pv[0],minor:h.pv[1],release:h.pv[2]}},hasFlashPlayerVersion:c,createSWF:function(t,r,q){if(h.w3cdom){return U(t,r,q)}else{return undefined}},removeSWF:function(q){if(h.w3cdom){X(q)}},createCSS:function(r,q){if(h.w3cdom){V(r,q)}},addDomLoadEvent:f,addLoadEvent:R,getQueryParamValue:function(v){var u=K.location.search||K.location.hash;if(v==null){return g(u)}if(u){var t=u.substring(1).split("&");for(var r=0;r<t.length;r++){if(t[r].substring(0,t[r].indexOf("="))==v){return g(t[r].substring((t[r].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(A&&M){var q=C(m);if(q){q.parentNode.replaceChild(M,q);if(l){W(l,true);if(h.ie&&h.win){M.style.display="block"}}M=null;l=null;A=false}}}}}();
$j=jQuery.noConflict();(function($){Number.prototype.bytes=function(){return this;};Number.prototype.kilobytes=function(){return this*1024;};Number.prototype.megabytes=function(){return this*(1024).kilobytes();};Number.prototype.gigabytes=function(){return this*(1024).megabytes();};Number.prototype.terabytes=function(){return this*(1024).gigabytes();};Number.prototype.petabytes=function(){return this*(1024).terabytes();};Number.prototype.exabytes=function(){return this*(1024).petabytes();};$.each(['byte','kilobyte','megabyte','gigabyte','terabyte','petabyte','exabyte'],function(){Number.prototype[this]=Number.prototype[this+'s'];});Number.prototype.toPercentage=function(precision){precision=parseInt(precision)||1;return(this*100).toFixed(precision)+'%';};Number.prototype.toHumanSize=function(precision){precision=parseInt(precision)||1;if(this<(1).kilobyte())return this+" Bytes";if(this<(1).megabyte())return(this/(1).kilobyte()).toFixed(precision)+' KB';if(this<(1).gigabytes())return(this/(1).megabyte()).toFixed(precision)+' MB';if(this<(1).terabytes())return(this/(1).gigabytes()).toFixed(precision)+' GB';if(this<(1).petabytes())return(this/(1).terabytes()).toFixed(precision)+' TB';if(this<(1).exabytes())return(this/(1).petabytes()).toFixed(precision)+' PB';return(this/(1).exabytes()).toFixed(precision)+' EB';};$.asterion=$.asterion||{};$.asterion.required=[];$.createCallbacks=function(object,names){names=$.makeArray(names);$.each(names,function(){var name=this;object['_callbacks']=object['_callbacks']||{};object['_callbacks'][name]=[];object[name]=function(){if(typeof(arguments[0])=='function'&&arguments.length==1){var callback=arguments[0];this._callbacks[name][this._callbacks[name].length]=callback;return this;}else{var result;for(var i=0;i<this._callbacks[name].length;i++){result=this._callbacks[name][i].apply(this,$.makeArray(arguments));if(result===false)return false;}
return true;}};});};$.asterion.clearIframes=function(element,callback,context){context=context||this;var iframes=$('iframe',element);if(iframes.length&&navigator&&navigator.appName=='Microsoft Internet Explorer'){iframes.each(function(){var $this=$(this);$this.attr('data-src',$this.attr('src')).attr('src','');});setTimeout(function(){callback.call(context);},100);}else{callback.call(context);}};$.asterion.restoreIframes=function(element){if(navigator&&navigator.appName=='Microsoft Internet Explorer'){$('iframe',element).each(function(){var $this=$(this);if($this.attr('src')=='')$this.attr('src',$this.attr('data-src'));});}};$.asterion.humanize=function(text){return text.replace('_',' ').replace(/\w+/g,function(a){return a.charAt(0).toUpperCase()+a.slice(1).toLowerCase();});};$.asterion.confirm_dialog=function(title,msg,buttons){$.asterion.dialog.confirm(msg,{buttons:buttons,title:title});};$.asterion.rjs=function(url,data){$.ajax({url:url,dataType:'script',data:data,type:'POST',beforeSend:function(xhr){xhr.setRequestHeader("Accept","text/javascript");}});}
$.asterion.confirm_delete=function(params){var link_target=params.link_target,dtitle=params.title,msg_target=params.msg_target,button1_txt=params.button1_txt||'Delete',button2_txt=params.button2_txt||'Cancel';$(link_target).click(function(e){var location=$(this).attr('href'),title=dtitle,msg=$(msg_target).html(),buttons=[{text:button1_txt,click:function(){$.asterion.rjs(location,{confirm:true});$(this).dialog("close");}},{text:button2_txt,click:function(){$(this).dialog("close");}}];$.asterion.confirm_dialog(title,msg,buttons);return false;});};$.asterion.alert=function(title,msg,ok_callback){var buttons=[{text:'OK',click:function(){$(this).dialog("close");if(ok_callback&&$.isFunction(ok_callback))ok_callback();}}];$.asterion.confirm_dialog(title,msg,buttons);};$.asterion.checkGuestbooks=function(){if($('.guestbook_component').length>0){$.asterion.alert('Guestbook Component','Only one Guestbook allowed per page');}else{$.asterion.componentIndicators.enable();$.asterion.dialog.close();}};$.asterion.offer_blog=function(){var title='No blog component',msg='<p>You currently have no blog component, so no one will be able to see your posts!</p><p>Would you like to add a blog component?</p>',buttons=[{text:'Yes, Add Blog',click:function(){var loc='/resource/component/add';$.asterion.rjs(loc,{confirm:true});$(this).dialog("close");}},{text:'No Thanks',click:function(){var loc='/resource/blog/post/manage';$.asterion.dialog.open(loc,{});$(this).dialog("close");}}];$.asterion.confirm_dialog(title,msg,buttons);};$(document).on('click','a.delete_component',function(event){var location=$(this).attr('href'),title='Delete Component',buttons=[{text:'Remove Component',click:function(){$.asterion.rjs(location,{confirm:true});$(this).dialog("close");}},{text:'Cancel',click:function(){$(this).dialog("close");}}],readonly=false;$($(this).parents()).each(function(i,e){if($(e).hasClass('asterion_readonly_component_editor')){return readonly=true;}});if(readonly){$.asterion.alert('Readonly!','Deleting this component has been disabled');event.preventDefault();return false;}
$.spinner().show();$.get(location,function(msg){$.spinner().hide();$.asterion.confirm_dialog(title,msg,buttons);});event.preventDefault();});$(document).on('click','a.copy_component',function(event){var $link=$(this);var location=$link.attr('href'),title='Copy Component',buttons=[{text:'Copy Component',click:function(){var page=$(this).closest('.ui-dialog').find('select').val(),component_id=$link.attr('href').split('/').pop(),same_page=(page==window.location.pathname),data={id:component_id,uri:page,insertAfterId:same_page?component_id:undefined};$.asterion.component.copy(data,function(new_component){if(same_page){$('#component_'+component_id).after(new_component);$.asterion.behaviors.addLocationHelperClasses();$(document).trigger('component.setup');}else{window.location=page;}});$(this).dialog("close");}},{text:'Cancel',click:function(){$(this).dialog("close");}}],readonly=false;$($(this).parents()).each(function(i,e){if($(e).hasClass('asterion_readonly_component_editor')){return readonly=true;}});if(readonly){$.asterion.alert('Readonly!','Copying this component has been disabled');event.preventDefault();return false;}
$.spinner().show();$.get(location,function(msg){$.spinner().hide();$.asterion.confirm_dialog(title,msg,buttons);});event.preventDefault();});$(document).on('click','a.restore_theme_image',function(e){var location=$(this).attr('href'),title='Restore Theme Image to Default',msg='<p>This will <b>remove the custom image</b> you have chosen for this location and <b>restore the default image</b> for the theme.</p>',buttons=[{text:'Use Default Image',click:function(){$.spinner().show();$.asterion.rjs(location,{confirm:true});$(this).dialog("close");}},{text:'Cancel',click:function(){$(this).dialog("close");}}];$.asterion.confirm_dialog(title,msg,buttons);e.preventDefault();});$(document).on('click','a.confirm_delete_page',function(e){var location=$(this).attr('href'),title='Delete Page',msg='<p>Removing this page will irreversibly remove the page and all components associated with it.</p><p>Are you sure you want to remove this page?</p>',buttons=[{text:'Delete Page',click:function(){$.asterion.rjs(location,{confirm:true});$(this).dialog("close");}},{text:'Cancel',click:function(){$(this).dialog("close");}}];$.asterion.confirm_dialog(title,msg,buttons);e.preventDefault();});$(document).on('click','#component_editor_container .delete_comment',function(e){var location=$(this).attr('href'),title='Delete Message',msg='<p>Really delete this message?  This cannot be undone.</p>',buttons=[{text:'Delete Message',click:function(){$.asterion.rjs(location,{confirm:true});$(this).dialog("close");}},{text:'Cancel',click:function(){$(this).dialog("close");}}];$.asterion.confirm_dialog(title,msg,buttons);e.preventDefault();});$.asterion.switchContentEditor=function(type,id){if(type==='visual'){$j('#'+id).tinymce().show();$j('#tiny_templates').show();$j('#html_editor_link').removeClass('active');$j('#visual_editor_link').addClass('active');}else{$j('#'+id).tinymce().hide();$j('#tiny_templates').hide();$j('#visual_editor_link').removeClass('active');$j('#html_editor_link').addClass('active');$j('#'+id).addClass('html_editor');$j('#'+id).css({'visibility':'visible','width':'762px'});}};$.asterion.showTooltip=function(contents,x,y){$('<div id="asterion_tooltip">'+contents+'</div>').css({top:y+5,left:x+5}).appendTo("body").fadeIn(200);};$.asterion.hideTooltip=function(){$j('#asterion_tooltip').remove();};$.asterion.parseBackgroundPosition=function(strg){if(typeof(strg)!=='string'||strg.length===0){return[0,'px',0,'px'];}
strg=strg.replace(/left|top/g,'0px');strg=strg.replace(/right|bottom/g,'100%');strg=strg.replace(/center/g,'50%');strg=strg.replace(/(\d+)(\s|\)|$)/g,"$1px$2");var res=strg.match(/(\d+)(px|\%|em|pt)\s(\d+)(px|\%|em|pt)/);if(!res)res=[0,0,0,0];return[parseFloat(res[1]||0),res[2]||0,parseFloat(res[3]||0),res[4]||0];};$.asterion.showLinkedAccounts=function(type){$('#select_'+type+'_account ul.account_selector').show();};$.asterion.changeLinkedAccount=function(type,account){$('#announce_'+type).val(account);$('#select_'+type+'_account label a').text($('#'+type+'_account_'+account+' a').text());$('#select_'+type+'_account ul.account_selector').hide();};$.asterion.flickrSelect=function(callback){var options=arguments[1]||{};var params='';if(options.username){params='?search_filter='+options.username;}
return this.dialog.open('/resource/flickr/browse'+params,{name:'flickr_browse',close:function(){if(arguments[0]&&arguments[1]){callback.apply(this,$.makeArray(arguments));}}});};$.asterion.youtubeSelect=function(callback){return $.asterion.dialog.open('/resource/youtube/search',{name:'youtube_browse',close:function(){if(arguments[0]){callback.apply(this,$.makeArray(arguments));}}});};$.asterion.assetSelect=function(callback){var options=arguments[1]||{},url;var queryOpts=[];options.type=options.type||'all';options.selection_type=options.selection_type||'all';var wrapped_callback=function(){if(arguments[0]&&arguments[1]){callback.apply(this,$.makeArray(arguments));}else{$.asterion.dialog.closeAll();}};if(options.upload){url=(options.type=='all'?'/resource/select/all/upload':'/resource/select;'+options.type+'/upload');if(options.collection!==''&&typeof(options.collection)!=='undefined'){url+='/collection/'+options.collection;}
url+='?direct_upload=true&active_tab=upload_files';if(options.selection_type!==''&&typeof(options.selection_type)!=='undefined'){url+='&selection_type='+options.selection_type;}
if(options.content_type!==''&&typeof(options.content_type)!=='undefined'){url+='&content_type='+options.content_type;}
if(options.file_types!==''&&typeof(options.file_types)!=='undefined'){url+='&file_types='+options.file_types;}
if(options.file_types_description!==''&&typeof(options.file_types_description)!=='undefined'){url+='&file_types_description='+options.file_types_description;}
if(options.component!==''&&typeof(options.component)!=='undefined'){url+='&component='+options.component;}
return $.asterion.dialog.open(url,{name:'asset_manager_browse',complete:function(){swfupload_manager.completion_callback=function(){if(options.closeOnUpload){callback.apply(this);$.asterion.dialog.close();return false;}
var successful_upload=$j('.successful_upload');if(successful_upload.length==1){if(options.type=='all'||options.type==successful_upload.data('file_data').type.toLowerCase()){$.ajax({url:'/resource/asset/select',type:'POST',dataType:'script',data:{asset_id:successful_upload.data('file_data').id,asset_url:successful_upload.data('file_data').url},success:function(){}});return false;}}};},close:wrapped_callback});}else if(options.library){url='/resource/image_library?lock_type=true&selector=true&type=all&active_tab=stock_photos';if(options.selection_type!==''&&typeof(options.selection_type)!=='undefined'){url+='&selection_type='+options.selection_type;}
return $.asterion.dialog.open(url,{name:'asset_manager_browse',close:wrapped_callback});}else{url=(options.type=='all'?'/resource/select':'/resource/select;'+options.type);if(options.url!=''&&typeof(options.url)!='undefined'){url+=options.url;}
if(options.content_type!==''&&typeof(options.content_type)!=='undefined'){queryOpts.push('content_type='+options.content_type);}
if(options.selection_type!==''&&typeof(options.selection_type)!=='undefined'){queryOpts.push('&selection_type='+options.selection_type);}
if(options.file_types!==''&&typeof(options.file_types)!=='undefined'){queryOpts.push('&file_types='+options.file_types);}
if(options.file_types_description!==''&&typeof(options.file_types_description)!=='undefined'){queryOpts.push('&file_types_description='+options.file_types_description);}
if(queryOpts.length)url+='?active_tab=browse_files&'+queryOpts.join('&');return $.asterion.dialog.open(url,{name:'asset_manager_browse',close:wrapped_callback});}};$.asterion.makePermalink=function(text){return text.toLowerCase().replace(/[&#'"\(\)\:%\$\?\+;,?\/\s.]/g,'-').replace(/--+/g,'-');};$.bind_function=function(func,obj){return function(){return func.apply(obj,$.makeArray(arguments));};};$.asterion.relativeDate=function(time){var date=new Date(parseInt(time,10)),diff=(((new Date()).getTime()-date.getTime())/1000),day_diff=Math.floor(diff/86400);if(isNaN(day_diff)||day_diff<0||day_diff>=365)
return'';return day_diff===0&&(diff<60&&"just now"||diff<120&&"1 minute ago"||diff<3600&&Math.floor(diff/60)+" minutes ago"||diff<7200&&"1 hour ago"||diff<86400&&Math.floor(diff/3600)+" hours ago")||day_diff==1&&"Yesterday"||day_diff<7&&day_diff+" days ago"||day_diff<31&&Math.ceil(day_diff/7)+" weeks ago"||day_diff<360&&Math.ceil(day_diff/30)+" months ago"||Math.ceil(day_diff/365)+" years ago";};$.fn.relativeDate=function(){return this.each(function(){var date=$.asterion.relativeDate(this.title);if(date){$(this).text(date);}});};$.fn.replaceWith=function(content){return this.before(content).remove();};$.fn.disableSelection=function(){return this.each(function(){this.unselectable="on";this.onselectstart=function(){return false;};if(this.style){this.style.MozUserSelect="none";}});};$.fn.reverse=[].reverse;$.fn.contains_coordinates=function(x,y,max_distance){max_distance=max_distance||0;var container=false;this.each(function(){var position=$(this).offset();position.right=position.left+$(this).get(0).offsetWidth;position.bottom=position.top+$(this).get(0).offsetHeight;var distance=Math.max(position.left-x,x-position.right,0)+Math.max(position.top-y,y-position.bottom,0);if(distance<=max_distance)
{container=$(this);return false;}});return container;};$.fn.overlap=function(x,y,axis){var container=$(this).contains_coordinates(x,y);if(!container)return false;var height=container.get(0).offsetHeight;var relative_position=(y)-container.offset().top;return relative_position/height;};$.fn.observe=function(time,callback){return this.each(function(){var element=this,prevVal=$(element).serialize(),observer,newValConfirm;observer=setInterval(function(){if(!$j(element).parents('body')[0]){clearInterval(observer);return;}
var newVal;newVal=$(element).serialize();if(prevVal!=newVal){if(newVal==newValConfirm){newValConfirm='';prevVal=newVal;callback.call(element);}
else
{newValConfirm=newVal;}}},time*1000);});};$.fn.fadeOutAndRemove=function(duration,callback){var $this=$(this);if(!$this.length)return;if($.isFunction(duration)){callback=duration;duration=null;}
duration=duration?duration:400;var lastItem=$($this[$this.length-1]).addClass('lastItem');var items=$this.not('.lastItem');items.fadeOut(duration,function(){items.remove();});lastItem.fadeOut(duration,function(){$(this).remove();if($.isFunction(callback)){callback();}});};$.fn.autosave=function(opts){var options={delay:1000*60,create:function(){},change:function(){},start:function(){},complete:function(){}};$.extend(options,opts);var textarea=this,enabled=true;textarea.one('oninit',function(e,editor){textarea.data('editor',editor).trigger('waitforchanges');options.create.call(textarea);});textarea.on('waitforchanges',function(){textarea.data('editor').onKeyDown.add(changed);});textarea.on('enable',function(e,enable_it){enabled=enable_it
if(enabled){textarea.trigger('waitforchanges');changed(textarea.data('editor'));}});textarea.on('save',function(e){var form=textarea.closest('form');if(!form.length)return;options.start.call(textarea);if(textarea.html().replace(/\s+/,'').length==0){textarea.trigger('waitforchanges');return;}
$.ajax({url:form.attr('action'),data:form.serialize(),dataType:'json',type:'post',error:function(response,textStatus,errorThrown){textarea.trigger('waitforchanges');},success:function(response,textStatus){options.complete.call(textarea,response,textStatus);if($.isFunction(form[0].saved))form[0].saved();$.asterion.dialog.reloadPageOnClose();$.asterion.dialog.reloadParentOnClose();textarea.trigger('waitforchanges');}});});var changed=function(editor){if($.asterion.dialog.hasUnsavedChanges()){options.change.call(textarea);editor.onKeyDown.remove(changed);setTimeout(autosave,options.delay);}}
var autosave=function(){if(!enabled)return;textarea.trigger('save');}};$.fn.ajaxScroll=function(options){var $this=$(this);var defaults={data:{},start:1,error:function(){return false;},success:function(){return true;}};options=$.extend(defaults,options);var in_progress=false;var inner_wrap=null;var prev_height=$this.height();$.asterion._ajax_page_counter=options.start;$(this).unbind('scroll');$(this).unbind('refresh');function load_content(refresh){refresh=refresh||false;in_progress=true;$.spinner().show();$.ajax($.extend({},options,{data:$.extend({page:$.asterion._ajax_page_counter},options.data),error:function(request,type){$.spinner().hide();options.error(request.responseText);},success:function(data){$.asterion._ajax_page_counter++;$.spinner().hide();options.success(data,refresh);var new_height=$this.height();if(new_height==prev_height){}else{prev_height=new_height;}
in_progress=false;}}));}
$this.scroll(function(e,refresh){inner_wrap=$('.ajax_scroll_inner_wrap',this);if(inner_wrap.length==0){$(this).wrapInner('<div class="ajax_scroll_inner_wrap"></div>');inner_wrap=$('.ajax_scroll_inner_wrap',this);}
if(this.offsetHeight+this.scrollTop>=this.scrollHeight&&!in_progress){load_content();}});$this.bind('refresh',function(e){$.asterion._ajax_page_counter=1;load_content(true);});};$.extend($.fx.step,{backgroundPosition:function(fx){if(fx.state===0&&typeof fx.end==='string'){var start=$.curCSS(fx.elem,'backgroundPosition');start=$.asterion.parseBackgroundPosition(start);fx.start=[start[0],start[2]];var end=$.asterion.parseBackgroundPosition(fx.end);fx.end=[end[0],end[2]];fx.unit=[end[1],end[3]];}
var nowPosX=[];nowPosX[0]=((fx.end[0]-fx.start[0])*fx.pos)+fx.start[0]+fx.unit[0];nowPosX[1]=((fx.end[1]-fx.start[1])*fx.pos)+fx.start[1]+fx.unit[1];fx.elem.style.backgroundPosition=nowPosX[0]+' '+nowPosX[1];}});$.ajaxSetup({converters:{"text asterionjavascript":function(textValue){return textValue;}}});if($.ui){$.ui.draggable.prototype.reset_position=function(newCursorAt){var o=this.options;if(newCursorAt)o.cursorAt=$.extend(o.cursorAt,newCursorAt);this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()};if(o.cursorAt){if(o.cursorAt.left!=undefined)this.offset.click.left=o.cursorAt.left+this.margins.left;if(o.cursorAt.right!=undefined)this.offset.click.left=this.helperProportions.width-o.cursorAt.right+this.margins.left;if(o.cursorAt.top!=undefined)this.offset.click.top=o.cursorAt.top+this.margins.top;if(o.cursorAt.bottom!=undefined)this.offset.click.top=this.helperProportions.height-o.cursorAt.bottom+this.margins.top;}};$.ui.sortable.prototype._originalIntersectsWithEdge=$.ui.sortable.prototype._intersectsWithEdge;$.ui.sortable.prototype._intersectsWithEdge=function(item){if(this.options.tolerance=="static"){var x1=this.positionAbs.left,x2=x1+this.helperProportions.width,y1=this.positionAbs.top,y2=y1+this.helperProportions.height;var l=item.left,r=l+item.width,t=item.top,b=t+item.height;var dyClick=this.offset.click.top,dxClick=this.offset.click.left;var isOverElement=(y1+dyClick)>t&&(y1+dyClick)<b&&(x1+dxClick)>l&&(x1+dxClick)<r;if(!isOverElement){return false;}
if(this.floating){return((l+r)/2>(dxClick+x1))?1:2;}else{return((t+b)/2>(dyClick+y1))?1:2;}
return false;}else{return this._originalIntersectsWithEdge(item);}};}
$(function($){if(!$('.asterion_toolbar_inner_wrapper').get(0)){return;}
$('#asterion_my_website, #asterion_my_content, #asterion_page_actions, #asterion_page_select, #asterion_layouts, #asterion_edit_theme').hover(function(event,manualTrigger){if(!$.asterion.componentEditor.draggingEditor||manualTrigger){$(this).find('ul.asterion_toolbar_dropdown_menu').fadeIn('fast');}},function(event,manualTrigger){if(!$.asterion.componentEditor.draggingEditor||manualTrigger){$(this).find('ul.asterion_toolbar_dropdown_menu').hide();}});bg_position=($.browser.msie&&document.documentMode>=9)?$('body').css('background-position-x')+' '+$('body').css('background-position-y'):$('body').css('background-position');var body_bg_position=$.asterion.parseBackgroundPosition(bg_position);if(body_bg_position[2]===0||body_bg_position[3]==='px'){var body_bg_positions={original:body_bg_position[0]+body_bg_position[1]+' '+(body_bg_position[2])+'px',lowered:body_bg_position[0]+body_bg_position[1]+' '+(body_bg_position[2]+69)+'px'};$('body').css('background-position',body_bg_positions.lowered);}
show_listener=function(){show_action();return false;}
show_action=function(){if(show_tab[0].timeout){clearTimeout(show_tab[0].timeout);}
show_tab.animate({top:'-38px'},{complete:function(){$('#remove_branding_link,.feedback').show();$j(this).remove();$('.unpublished, .invisible').slideDown();$j("#asterion_toolbar").slideDown();$j("#asterion_page_wrapper").animate({paddingTop:'69px',paddingBottom:'25px'});if(body_bg_positions){$j('body').animate({backgroundPosition:'('+body_bg_positions.lowered+')'});}
document.cookie='toolbar_status=show; path=/';}});};hide_listener=function(){hide_action({animate:true});return false;}
hide_action=function(options){if($.asterion.component.layoutMode===true){$.asterion.component.toggleLayoutMode();$('#asterion_layout_mode').removeClass('active_status_link');}
show_tab=$('<div id="show_tab" class="asterion_secondary_color asterion_secondary_bgcolor asterion_hover_color">\
          <div id="asterion_hide_explanation" class="asterion_secondary_color asterion_secondary_bgcolor">While the toolbar is hidden, all editing features are disabled.</div>\
          <a href="javascript:void(0)" id="asterion_show_link" class="toggle_tab">Show Editor</a>\
          </div>').prependTo(document.body);if(options.animate==true){show_tab[0].timeout=setTimeout(function(){$j("#asterion_hide_explanation").fadeOut();},5000);}else{$j("#asterion_hide_explanation").hide();}
$('#asterion_show_link').click(show_listener);if(options.animate==true){$('.unpublished, .invisible').slideUp();$j("#asterion_toolbar").slideUp();$j("#asterion_page_wrapper").animate({paddingTop:0,paddingBottom:0},{complete:function(){show_tab.animate({top:'-2px'});$('#remove_branding_link,.feedback').hide();}});}else{$('.unpublished, .invisible').hide();$j("#asterion_toolbar").hide();$j("#asterion_page_wrapper").css({paddingTop:0,paddingBottom:0});show_tab.css({top:'-2px'});}
if(body_bg_positions){if(options.animate==true){$j('body').animate({'background-position-y':body_bg_positions.original.split(' ')[1]});}else{$j('body').css({backgroundPosition:'('+body_bg_positions.original+')'});}}
document.cookie='toolbar_status=hide; path=/';return false;};$('#asterion_hide_link').click(hide_listener);$('#asterion_layout_mode a').click(function(){$(this).text($(this).text()=='Collapse Blocks'?'Expand Blocks':'Collapse Blocks');$.asterion.component.toggleLayoutMode();});if(document.cookie.indexOf('toolbar_status=hide')!=-1){hide_action({animate:false});}
$('#asterion_toolbar').disableSelection();});$.fn.confirmAction=function(options){var settings={title:'Confirmation',message:'Really do this?',action_button:'Do It',cancel_button:'Cancel',click:function(){},error:function(jqXHR,textStatus,errorThrown){},success:function(content,textStatus,jqXHR){}}
settings=$.extend(settings,options);$(document).on('click',this.selector,function(event){var $this=$(this),url=$this.attr('href');var execute_it=function(){$.ajax({url:url+'?confirm=true',dataType:'json',type:'POST',statusCode:{200:function(content,textStatus,jqXHR){settings.success.call($this,content,textStatus,jqXHR);}},error:function(jqXHR,textStatus,errorThrown){settings.error.call(jqXHR,textStatus,errorThrown);}});}
if(false==settings.click.call(this,event,execute_it)){return false;}
var dialog_opts={title:$.isFunction(settings.title)?settings.title.call($this):settings.title,buttons:[{text:$.isFunction(settings.action_button)?settings.action_button.call($this):settings.action_button,click:function(){execute_it();$(this).dialog('close');}},{text:$.isFunction(settings.cancel_button)?settings.cancel_button.call($this):settings.cancel_button,click:function(){$(this).dialog('close');}}]}
$.asterion.dialog.confirm($.isFunction(settings.message)?settings.message.call($this):settings.message,dialog_opts);return false;});}
$.fn.preload=function(callback){var $images=$('img',this),to_load=$images.length;if($images.length==0)callback();$images.each(function(){var img=new Image();img.src=this.src;img.onload=function(){to_load--;if(to_load<=0)callback();}});};$.fn.spinner=function(){var $spinner=$('#spinner');if(!$spinner.length)$spinner=$('<div id="spinner"></div>').hide();if(!$spinner.parent().length&&!$(this).length){if($.asterion.dialog.visible()){$('.dialog_core',$.asterion.dialog.visibleDialog()).append($spinner);}else{$('body').append($spinner);}}
if($(this).length)$(this).append($spinner);if($('body > #spinner').length){$spinner.css({position:'fixed'});}else{$spinner.css({position:'absolute'});}
return $spinner;};$.fn.attention=function(){$(this).css({backgroundColor:'#FFEAE8'}).animate({backgroundColor:'#fff'},1000,function(){$(this).css('backgroundColor','transparent');});};$.fn.serializeObject=function(){var o={};var a=this.serializeArray();$.each(a,function(){if(o[this.name]){if(!o[this.name].push){o[this.name]=[o[this.name]];}
o[this.name].push(this.value||'');}else{o[this.name]=this.value||'';}});return o;};$.extend({containerWidth:function(){var loc=$('#'+$.cookie('editing_location'));var pr=parseInt(loc.css('padding-right'));var pl=parseInt(loc.css('padding-left'));var w=loc.width()-(pr+pl);return w;},spinner:function(){return $().spinner();},browser:(function(){var ie=(function(){var v=3,div=document.createElement('div'),all=div.getElementsByTagName('i');while(div.innerHTML='<!--[if gt IE '+(++v)+']><i></i><![endif]-->',all[0]);return v>4?v:false;}());return{msie:ie,version:ie};})(),deparam:function(querystring){var querystring=querystring.substring(querystring.indexOf('?')+1),params={},queries=querystring.split('&'),temp;for(var i=0,l=queries.length;i<l;i++){temp=queries[i].split('=');params[temp[0]]=temp[1];}
return params;},decodeEntities:(function(){var $element=$('<div>');function decodeHTMLEntities(str){if(str&&typeof str==='string'){str=str.replace(/<script[^>]*>([\S\s]*?)<\/script>/gmi,'');str=str.replace(/<\/?\w(?:[^"'>]|"[^"]*"|'[^']*')*>/gmi,'');str=$element.html(str).text();$element.html('');}
return str;}
return decodeHTMLEntities;})()});})(jQuery);String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"");};String.prototype.permalink=function(){return this.replace(/\W+/g,' ').trim().toLowerCase().replace(/\s+/g,'-');};function urldecode(str){return unescape(str.replace(/\+/g,' '));}
function flashMessage(message){var msg=$j('#flash_message');if(!msg.length)return;msg.html(message);msg.fadeIn('slow',function(){setTimeout(function(){msg.fadeOut('slow');},3000);});}
function padLeft(str,pad_limit,pad_with){str=String(str);pad_with=String(pad_with);var pad_length=pad_limit-str.length;for(i=0;i<pad_length;i++)str=pad_with+str;return str;}
function padRight(str,pad_limit,pad_with){str=String(str);pad_with=String(pad_with);var pad_length=pad_limit-str.length;for(i=0;i<pad_length;i++)str+=pad_with;return str;}
function sleep(ms){ms+=new Date().getTime();while(new Date()<ms){}}
if(!Array.prototype.indexOf){Array.prototype.indexOf=function(obj,start){for(var i=(start||0),j=this.length;i<j;i++){if(this[i]===obj){return i;}}
return-1;}}
function get_id(component,element_type){return $j(component).attr('id').replace(element_type+"_","");}
function getId(element){var id=$j(element).attr('id'),matches;if(matches=id.match(/_(\d+)$/))return parseInt(matches[1]);return null;};function show_loading_indicator(el,message){$j('#'+el).addClass('loading_indicator');}
function remove_loading_indicator(){$j('.loading_indicator').removeClass('loading_indicator');}
function button_change(element){var checked=$j(element).is(':checked'),name=$j(element).attr('name');elements=$j('#label_'+name+', #div_'+name);if(checked){elements.addClass('asterion_button_change_on');}
else{elements.removeClass('asterion_button_change_on');}}
function submit_dialog_form(element_id){var form=$j(element_id).parents().andSelf().filter('form')[0];if(form){$j(form).submit();return false;}}
function dialog_form_disable(form){$j(form).addClass('disabled').find('.asterion_dialog_submit .dialog_button').addClass('button_disabled');}
function dialog_form_enable(form){$j(form).removeClass('disabled').find('.asterion_dialog_submit .dialog_button').removeClass('button_disabled');}
(function($){$.asterion=$.asterion||{};$.asterion.behaviors={removeScripts:function(){setTimeout("$j('.component script').remove();",1);},attachToRelativeDates:function(){$('.relative_date').relativeDate().removeClass('relative_date');},attachToDialogHeaders:function(){},attachToGraphicalSelect:function(){$('ul.account_selector').bind('mouseleave',function(){$(this).hide();});var select_items=$('.graphical_select');var images=select_items.find('img');var text=select_items.find('span');var inputs=select_items.find("input[type='radio']");var checked_input=$("input[type='radio']:checked").parent();checked_input.find('img').css('border','3px solid #3f98d7');checked_input.find('span').css('color','#3f98d7');inputs.css('display','none');images.click(function(){var list_item=$(this).parent().parent();list_item.find('input').get(0).checked='checked';images.css('border','3px solid #bfbeb6');text.css('color','#4F4B40');$(this).css('border','3px solid #3f98d7');list_item.find('span').css('color','#3f98d7');});},addLocationHelperClasses:function(){$('.location').each(function(loc){var bitem;var c=$(this).find(".component").removeClass("first last even odd").filter(":first").addClass("first").end().filter(':even').addClass("even").end().filter(':odd').addClass("odd").end().filter(":last").addClass("last").end();for(i=0;i<c.length;i++){bitem=$(c[i]).attr("class").match(/(item_\d+)/);if(bitem)$(c[i]).removeClass(bitem[0]);$(c[i]).addClass("item_"+i.toString());}});},attachToRichTextEditors:function(){$j('textarea.rich_text_editor').each(function(){var textarea=$(this);if(!textarea.data('mce_applied')){textarea.data('mce_applied',true);$.asterion.dialog.visibleDialog().find('.dialog_core').spinner().show();textarea.tinymce({script_url:'/tinymce/tiny_mce_src.js',forced_root_block:'p',plugins:'pagebreak,inlinepopups,inlinesourceeditor,asterion_contrast,paste,asterion_paragraph,asterion_template,table,asterion_code,asterion_charmap,asterion_link,asterion_image,asterion_youtube',inlinepopups_skin:'jigsy',mode:'none',theme:'jigsy',valid_elements:'a[*],strong/b[*],em/i[*],strike[*],u[*],#p[*],-ol[*],-ul[*],-li[*],br[*],img[*],-sub[*],-sup[*],-blockquote[*],-table[*],-tr[*],tbody[*],thead[*],tfoot[*],#td[*],#th[*],caption[*],-div[*],-span[*],-code[*],-pre[*],address[*],-h1[*],-h2[*],-h3[*],-h4[*],-h5[*],-h6[*],hr[*],-font[*],dd[*],dl[*],dt[*],cite[*],abbr[*],acronym[*],del[*],ins[*],object[*],param[name|value],embed[*],script[*],map[*],area[*],bdo[*],button[*],col[*],colgroup[*],dfn[*],fieldset[*],form[*],input[*],kbd[*],label[*],legend[*],noscript[*],optgroup[*],option[*],q[*],samp[*],select[*],small[*],textarea[*],tt[*],var[*],big',extended_valid_elements:'iframe[*],script[language|type|src],object[style|class|type|width|height|data]',verify_html:true,width:'100%',height:'100%',browser_spellcheck:true,tab_focus:':next',convert_urls:false,remove_linebreaks:false,relative_urls:false,remove_script_host:true,paste_remove_styles:false,oninit:function(editor){$.asterion.dialog.handleSizing();textarea.trigger('oninit',editor);},setup:function(editor){editor.onInit.add(function(editor){$.spinner().hide();});editor.onBeforeGetContent.add(function(editor){editor.dom.run(editor.dom.select('.safety_break'),function(el){editor.dom.remove(el);});var last_element=editor.dom.select('body > *:last')[0];if(!(typeof(last_element)==='undefined')){if(last_element.nodeName==='P'&&(/^\s*$/).test(last_element.innerHTML)){editor.dom.remove(last_element);}}});editor.onNodeChange.add(function(editor){var br=editor.dom.create('br',{'class':'safety_break'});var last_element=editor.dom.select('body > *:last')[0];if(!(typeof(last_element)==='undefined')){var last_element_name=last_element.nodeName;if(last_element_name==='TABLE'||last_element_name==='PRE'){editor.dom.insertAfter(br,last_element);}else if(last_element_name==='P'){var last_element_of_p=editor.dom.select('*:last',last_element)[0];if(!(typeof(last_element_of_p)==='undefined')){var last_element_name_of_p=last_element_of_p.nodeName;if(last_element_name_of_p==='PRE'){editor.dom.insertAfter(br,last_element_of_p);}}}}});}});}});},attachToCodeEditors:function(){if($j('#dialog_main iframe').length===0||$('.richtext_field').length!==0){$.each($('.code_editor'),function(){var editors=$("textarea",$.asterion.dialog.visibleDialog());var file_type=$(this).attr('class').split(' ')[1];var code_type=(file_type=='html'?'xml':file_type);if(file_type=='js'){var parser_files=['parsejavascript.js','tokenizejavascript.js'];}else if(file_type=='html'){parser_files=['parsexml.js'];}else{parser_files=['parse'+file_type+'.js'];}
var options={path:"/codemirror/js/",parserfile:parser_files,stylesheet:"/codemirror/css/"+code_type+"colors.css",height:'100%',width:'992px',tabMode:'spaces',enterMode:'indent',autofocus:true};var editor=new CodeMirror.fromTextArea(this.id,options);editors.css('visibility','visible');var $this=$(this),dialog=$.asterion.dialog.visibleDialog();$this.parents('form',dialog).data('codeMirror',editor);$this.parents('form',dialog).submit(function(e){$this.val(editor.getCode());$this.trigger('save',[e,editor.getCode()]);});});}},attachToColorPicker:function(){$.each($('.color_picker_box'),function(){hex_raw=$(this).find('.hex_value').val();hex_value=(hex_raw.match(/^(([a-fA-F0-9]){3}){1,2}$/)?hex_raw:"FFFFFF");$(this).find('.current_picker_color').css('backgroundColor','#'+hex_value);$(this).hover(function(){$(this).find('.color_picker_container').show();},function(){$(this).find('.color_picker_container').hide();});var that=this;$(this).find('.color_picker_container').ColorPicker({flat:true,color:'#00ff00',onChange:function(hsb,hex,rgb){hex_value=(hex.match(/^(([a-fA-F0-9]){3}){1,2}$/)?hex:"FFFFFF");$(that).find('.current_picker_color').css('backgroundColor','#'+hex_value);$(that).find('.hex_value').val(hex_value).trigger('colorchange');}});});}};$.createCallbacks($.asterion.behaviors,["attach","beforeSubmit","afterSubmitFailure"]);$.asterion.behaviors.attach($.asterion.behaviors.attachToCodeEditors);$.asterion.behaviors.attach($.asterion.behaviors.removeScripts);$.asterion.behaviors.attach($.asterion.behaviors.attachToGraphicalSelect);$.asterion.behaviors.attach($.asterion.behaviors.attachToRelativeDates);$.asterion.behaviors.attach($.asterion.behaviors.addLocationHelperClasses);$.asterion.behaviors.attach($.asterion.behaviors.attachToColorPicker);$.asterion.commentNotification=function(text){text=text.replace(/^\s+|\s+$/g,'');if(!text.length)return;if($('#comments_item').length==0)$('#asterion_top_row_nav').prepend('<li id="comments_item"></li>');$('#comments_item').html(text);};$(function(){$.asterion.behaviors.attach();$.asterion.behaviors.attachToRichTextEditors();$(document).ajaxComplete(function(){$.asterion.behaviors.attach();$.asterion.behaviors.attachToRichTextEditors();});});$(document).on('click','a.ajax_link',function(e){var parent_dialog=$(this).parents('.dialog_scroll_wrapper');$.ajax({url:$(this).attr('href'),dataType:'script',type:'POST',beforeSend:function(xhr){if(parent_dialog.data('current_url')){xhr.setRequestHeader("X-Asterion-Dialog-Referer",parent_dialog.data('current_url'));}
xhr.setRequestHeader("Accept","text/javascript");}});e.preventDefault();});$(document).on('submit','form.ajax_form',function(event){var form=this,$form=$(this);var options=arguments[1]||{};if($form.hasClass('disabled'))return false;dialog_form_disable(form);if($.asterion.behaviors.beforeSubmit(form)){var post_data=$(form).serialize();var parent_dialog=$(form).parents('.dialog_scroll_wrapper');$.ajax({url:$(form).attr('action'),data:post_data,dataType:'asterionjavascript',type:'post',beforeSend:function(xhr){if(parent_dialog.data('current_url')){xhr.setRequestHeader("X-Asterion-Dialog-Referer",parent_dialog.data('current_url'));}},error:function(response,textStatus,errorThrown){$form.trigger('error',arguments);dialog_form_enable(form);if($.asterion.behaviors.afterSubmitFailure(response,textStatus,errorThrown)){$.globalEval(response);}},success:function(response,textStatus){$form.trigger('success',arguments);if(typeof(form.saved)=='function'){form.saved();}
if(typeof(options.success)=='function'&&!options.success()){return;}
$.globalEval(response);},complete:function(){$form.trigger('complete',arguments);}});}else{dialog_form_enable(form);}
return false;});$(document).on('mouseenter','.asterion_selection',function(){if($(this).hasClass('inactive'))return false;$(this).addClass('active');$(this).find('ul').show();}).on('mouseleave','.asterion_selection',function(){if($(this).hasClass('inactive'))return false;$(this).removeClass('active');$(this).find('ul').hide();});$(document).on('mceInlineSourceEditor.hide',function(){$('.dialog_preview').remove();$('.asterion_dialog_submit button').show();$('#blog_save_draft_button').show();$('#autosave_toggle').show();$('.massive_dialog .richtext_field').css({'width':'998px'})});$(document).on('mceInlineSourceEditor.show',function(){$('.asterion_dialog_submit button').before('<a class="dialog_preview ok dialog_button">Preview</a>');$('.dialog_preview').click(function(){$('#richtext_editor_tab').click();});$('.massive_dialog .richtext_field').css({'width':'980px'})
$('.asterion_dialog_submit button').hide();$('#blog_save_draft_button').hide();$('#autosave').removeAttr('checked');$('#autosave_toggle').hide();});$('#component_editor_container .delete_blog_post').confirmAction({title:'Delete Blog Post',message:'Really delete this blog post?  This cannot be undone.',action_button:'Delete Blog Post',success:function(content,textStatus,jqXHR){var $this=$(this),url=$this.attr('href'),id=url.split('/').pop(),post=$('.blog_post_'+id);$(document).trigger('blog.delete',id);post.attention().fadeOut();var paging=$('.blog_component .paging_info b'),count=paging.html();if(count){count=count.replace(/([a-zA-Z ]+)?(\d+)/,function(match,$1,$2){var n=parseInt($2)-1;return(!$1||n==1)?n:$1+n;});paging.html(count);}}});})(jQuery);(function($){$.asterion=$.asterion||{};$.asterion.mapComponent={setupMap:function(map_element,id,data){var latlng=new google.maps.LatLng(data.center[0],data.center[1]);var options={zoom:data.zoom,center:latlng,mapTypeControl:true,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},mapTypeId:google.maps.MapTypeId.ROADMAP,navigationControl:true,navigationControlOptions:{style:google.maps.NavigationControlStyle.DEFAULT}};var map=new google.maps.Map(document.getElementById(map_element),options);if(data.allow_directions===true){var directionsDisplay=new google.maps.DirectionsRenderer({draggable:true});var directionsPanel=map_element+'_panel';directionsDisplay.setMap(map);directionsDisplay.setPanel(document.getElementById(directionsPanel));$j('#component_'+id+'_google_map_directions_form').submit(function(){$j.asterion.mapComponent.directions(directionsDisplay,directionsPanel,$j('#component_'+id+'_google_map_directions_form input#start_point').val(),data.center[0]+','+data.center[1]);return false;});}
var marker=new google.maps.Marker({position:latlng,title:'',map:map});var markerHtml=data.marker_content;if(markerHtml){var infoWindow=new google.maps.InfoWindow({content:"<div>"+markerHtml+"</div>"});infoWindow.open(map,marker);google.maps.event.addListener(marker,'click',function(){infoWindow.open(map,marker);});}
if(data.feed_url!==''){$j.asterion.mapComponent.loadFeed(map,data.feed_url);}},setupAdminMap:function(map,data){var admin_latlng=new google.maps.LatLng(data.center[0],data.center[1]);var admin_options={zoom:data.zoom,center:admin_latlng,mapTypeControl:true,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},mapTypeId:google.maps.MapTypeId.ROADMAP,navigationControl:true,navigationControlOptions:{style:google.maps.NavigationControlStyle.DEFAULT}};var admin_map=new google.maps.Map(document.getElementById(map),admin_options);var admin_marker=new google.maps.Marker({position:admin_latlng,title:'',draggable:true,map:admin_map});google.maps.event.addListener(admin_marker,'dragend',function(){$j('input#component_latitude').val(admin_marker.getPosition().lat());$j('input#component_longitude').val(admin_marker.getPosition().lng());});google.maps.event.addListener(admin_map,'zoom_changed',function(){$j('input#component_zoom').val(admin_map.getZoom());});$j.asterion.mapComponent.adminMarker=admin_marker;$j.asterion.mapComponent.adminMap=admin_map;if(data.feed_url!==''){$j.asterion.mapComponent.loadFeed(admin_map,data.feed_url);}},lookupAddress:function(address_id){var address=$('#'+address_id).get(0).value;var geocoder=new google.maps.Geocoder();var lookup_map=$j.asterion.mapComponent.adminMap;var lookup_marker=$j.asterion.mapComponent.adminMarker;geocoder.geocode({'address':address},function(results,status){if(status==google.maps.GeocoderStatus.OK){$j('#geocode_errors').html('');lookup_map.setCenter(results[0].geometry.location);lookup_marker.setPosition(results[0].geometry.location);google.maps.event.trigger($.asterion.mapComponent.adminMarker,'dragend');if($('textarea#component_marker_content').length){$('textarea#component_marker_content').val(results[0].formatted_address);var markerHtml=results[0].formatted_address;var infoWindow=new google.maps.InfoWindow({content:"<div>"+markerHtml+"</div>"});infoWindow.open(lookup_map,lookup_marker);}}else{$j('#geocode_errors').html("Could not find address specified: "+status);}});},addFeed:function(url){var map=$j.asterion.mapComponent.adminMap;$j.asterion.mapComponent.loadFeed(map,url);},directions:function(display,panel,start,end){var directionsService=new google.maps.DirectionsService();var request={origin:start,destination:end,travelMode:google.maps.DirectionsTravelMode.DRIVING};directionsService.route(request,function(response,status){if(status==google.maps.DirectionsStatus.OK){$j('#'+panel).empty();display.setDirections(response);}else{$j('#'+panel).empty().html('<p>Sorry, we couldn\'t find a route!<p>');}});},loadFeed:function(map,url){var feedLayer=new google.maps.KmlLayer(url);feedLayer.setMap(map);}};})(jQuery);(function($){$.asterion=$.asterion||{};$.asterion.videoPlayerComponent={updateBuffering:function(component_id,is_buffering){var progress_width=($j('#'+component_id+' .video_player_controls .progress').width()-($j('#'+component_id+' .video_player_controls .progress .total_time').width()*2)-25);$j('#'+component_id+' .video_player_controls .progress_bar').css('width',progress_width);if(is_buffering){$j('#'+component_id+' .video_player_controls .is_buffering').css('display','block');}else{$j('#'+component_id+' .video_player_controls .is_buffering').css('display','none');}},updateLoadedBytes:function(component_id,bytes,total_bytes){$j('#'+component_id+' .video_player_controls .loaded_bytes').text(bytes);$j('#'+component_id+' .video_player_controls .total_bytes').text(total_bytes);var percent=bytes/total_bytes;var progress_bar_width=$j('#'+component_id+' .video_player_controls .progress_bar').width();var bar_width=progress_bar_width*percent;$j('#'+component_id+' .video_player_controls .progress_bar .buffer_progress_bar').width(bar_width);$j('#'+component_id+' .video_player_controls .progress_bar .panner').width(bar_width);},updateCurrentTime:function(component_id,time,total_time,time_string,total_time_string){$j('#'+component_id+' .video_player_controls .current_time').text(time_string);$j('#'+component_id+' .video_player_controls .total_time').text(total_time_string);var percent=time/total_time;var progress_bar_width=$j('#'+component_id+' .video_player_controls .progress_bar').width();var bar_width=progress_bar_width*percent;$j('#'+component_id+' .video_player_controls .progress_bar .playback_progress_bar').width(bar_width);$j('#'+component_id+' .video_player_controls .progress_bar .playhead').css('left',bar_width+'px');},playbackComplete:function(component_id){},playStateChange:function(component_id,play_state){if(play_state=="paused"){$j('#'+component_id+' .video_player_controls .playback_button').removeClass('pause_button').addClass('play_button');}else if(play_state=="playing"){$j('#'+component_id+' .video_player_controls .playback_button').removeClass('play_button').addClass('pause_button');}},currentVolume:function(component_id,volume){volumeChanged(component_id,volume);},muteChanged:function(component_id,muted){if(muted===true){$j('#'+component_id+' .video_player_controls .volume .toggle_mute').removeClass('active').addClass('muted');}else{$j('#'+component_id+' .video_player_controls .volume .toggle_mute').removeClass('muted').addClass('active');}},volumeChanged:function(component_id,volume){switch(volume){case 1:$j('#'+component_id+' .video_player_controls .volume').removeClass('percent_66').removeClass('percent_33').removeClass('percent_0').addClass('percent_100');break;case 0.66:$j('#'+component_id+' .video_player_controls .volume').removeClass('percent_100').removeClass('percent_33').removeClass('percent_0').addClass('percent_66');break;case 0.33:$j('#'+component_id+' .video_player_controls .volume').removeClass('percent_66').removeClass('percent_100').removeClass('percent_0').addClass('percent_33');break;case 0:$j('#'+component_id+' .video_player_controls .volume').removeClass('percent_66').removeClass('percent_33').removeClass('percent_100').addClass('percent_0');break;default:$j('#'+component_id+' .video_player_controls .volume').removeClass('percent_66').removeClass('percent_33').removeClass('percent_0').addClass('percent_100');break;}},togglePlayback:function(flash_object){document.getElementById(flash_object).togglePlayback();},setVolume:function(flash_object,volume){document.getElementById(flash_object).setVolume(volume);},toggleMute:function(flash_object){document.getElementById(flash_object).toggleMute();},panTo:function(flash_object,time){document.getElementById(flash_object).panTo(time);},replay:function(flash_object){document.getElementById(flash_object).replay();},setup:function(component_id){$j('#'+component_id+' .video_player_container').bind("mouseenter",function(){$j('.video_player_caption',this).animate({height:'show',opacity:'show'},'slow');$j('.video_player_controls',this).animate({height:'show',opacity:'show'},'slow');}).bind("mouseleave",function(){$j('.video_player_caption',this).animate({height:'hide',opacity:'hide'},'slow');$j('.video_player_controls',this).animate({height:'hide',opacity:'hide'},'slow');});$j('#'+component_id+' .panner').click(function(e){flash_object='video_player_'+component_id.replace(/component_/,'');var position=e.pageX-$j(this).offset().left;var width=$j(this).width();var percentage=position/width;var time=$j('#'+component_id+' .video_player_controls .total_time').text().split(':');var converted_time=parseInt(time[0]*60,10)+parseInt(time[1],10);var calculated=converted_time*percentage;$j.asterion.videoPlayerComponent.panTo(flash_object,calculated);});}};})(jQuery);(function($){$.fn.asterion_expandable=function(options){var url=options.url||'',params=options.params||{},template=options.template||function(data){return'no template found'},listener=function(){var self=$(this),pending=false,clicked=function(event){var etarget=$(event.target),ajax_response=function(data){pending=false;etarget.removeClass('loading');etarget.after(template(data));$(etarget.siblings()[0]).slideToggle();etarget.toggleClass('expand collapsed');};if(etarget.is('a')&&etarget.parent().is('li')){if(etarget.siblings().length===0&&pending!==true){etarget.addClass('loading');pending=true;$.ajax({type:"GET",url:url+etarget.attr('id'),data:params,cache:false,success:ajax_response,dataType:'json'});}else if(pending!==true){$(etarget.siblings()[0]).slideToggle();etarget.toggleClass('expand collapsed');}}};self.bind('click',clicked);};return this.each(listener);};})(jQuery);(function($){var isLoading=false;$.prettyPhoto={version:'3.1.4'};$.fn.prettyPhoto=function(pp_settings){pp_settings=jQuery.extend({gallery_url:false,hook:'rel',animation_speed:'fast',ajaxcallback:function(){},slideshow:5000,autoplay_slideshow:false,opacity:0.80,show_title:true,allow_resize:true,allow_expand:true,default_width:500,default_height:344,counter_separator_label:'/',theme:'pp_default',horizontal_padding:20,hideflash:false,wmode:'opaque',autoplay:true,modal:false,deeplinking:true,overlay_gallery:true,overlay_gallery_max:30,keyboard_shortcuts:true,changepicturecallback:function(){},callback:function(){},ie6_fallback:true,markup:'<div class="pp_pic_holder"> \
      <div class="ppt"> \
       <a class="pp_close" href="#">Close</a> \
              <span>&nbsp;</span> \
            </div> \
      <div class="pp_top"> \
       <div class="pp_left"></div> \
       <div class="pp_middle"></div> \
       <div class="pp_right"></div> \
      </div> \
      <div class="pp_content_container"> \
       <div class="pp_left"> \
       <div class="pp_right"> \
        <div class="pp_content"> \
         <div class="pp_loaderIcon"></div> \
         <div class="pp_fade"> \
              <a href="#" class="pp_expand" title="Expand the image">Expand</a> \
          <div class="pp_hoverContainer"> \
           <a class="pp_next" href="#">next</a> \
           <a class="pp_previous" href="#">previous</a> \
          </div> \
          <div id="pp_full_res"></div> \
          <div class="pp_details"> \
           <div class="pp_nav"> \
            <a href="#" class="pp_arrow_previous">Previous</a> \
            <p class="currentTextHolder">0/0</p> \
            <a href="#" class="pp_arrow_next">Next</a> \
           </div> \
           <p class="pp_description"></p> \
           <div class="pp_social">{pp_social}</div> \
          </div> \
         </div> \
        </div> \
       </div> \
       </div> \
      </div> \
      <div class="pp_bottom"> \
       <div class="pp_left"></div> \
       <div class="pp_middle"></div> \
       <div class="pp_right"></div> \
      </div> \
     </div> \
     <div class="pp_overlay"></div>',gallery_markup:'<div class="pp_gallery"> \
        <a href="#" class="pp_arrow_previous">Previous</a> \
        <div> \
         <ul> \
          {gallery} \
         </ul> \
        </div> \
        <a href="#" class="pp_arrow_next">Next</a> \
       </div>',image_markup:'<img id="fullResImage" src="{path}" />',flash_markup:'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="{width}" height="{height}"><param name="wmode" value="{wmode}" /><param name="allowfullscreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="movie" value="{path}" /><embed src="{path}" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="{width}" height="{height}" wmode="{wmode}"></embed></object>',quicktime_markup:'<object classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" codebase="http://www.apple.com/qtactivex/qtplugin.cab" height="{height}" width="{width}"><param name="src" value="{path}"><param name="autoplay" value="{autoplay}"><param name="type" value="video/quicktime"><embed src="{path}" height="{height}" width="{width}" autoplay="{autoplay}" type="video/quicktime" pluginspage="http://www.apple.com/quicktime/download/"></embed></object>',iframe_markup:'<iframe src ="{path}" width="{width}" height="{height}" frameborder="no"></iframe>',inline_markup:'<div class="pp_inline">{content}</div>',custom_markup:'',social_tools:'<div class="twitter"><a href="http://twitter.com/share" class="twitter-share-button" data-count="none">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script></div><div class="facebook"><iframe src="//www.facebook.com/plugins/like.php?locale=en_US&href={location_href}&amp;layout=button_count&amp;show_faces=true&amp;width=500&amp;action=like&amp;font&amp;colorscheme=light&amp;height=23" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:500px; height:23px;" allowTransparency="true"></iframe></div>'},pp_settings);var matchedObjects=this,percentBased=false,pp_dimensions,pp_open,pp_contentHeight,pp_contentWidth,pp_containerHeight,pp_containerWidth,windowHeight=$(window).height(),windowWidth=$(window).width(),pp_slideshow;doresize=true,scroll_pos=_get_scroll();$(window).unbind('resize.prettyphoto').bind('resize.prettyphoto',function(){_center_overlay();_resize_overlay();});if(pp_settings.keyboard_shortcuts){$(document).unbind('keydown.prettyphoto').bind('keydown.prettyphoto',function(e){if(typeof $pp_pic_holder!='undefined'){if($pp_pic_holder.is(':visible')){switch(e.keyCode){case 37:$.prettyPhoto.changePage('previous');e.preventDefault();break;case 39:$.prettyPhoto.changePage('next');e.preventDefault();break;case 27:if(!settings.modal)
$.prettyPhoto.close();e.preventDefault();break;};};};});};$.prettyPhoto.initialize=function(e){settings=pp_settings;if(settings.theme=='pp_default')settings.horizontal_padding=16;if(settings.ie6_fallback&&$.browser.msie&&parseInt($.browser.version)==6)settings.theme="light_square";theRel=$(this).attr(settings.hook);galleryRegExp=/\[(?:.*)\]/;isSet=(galleryRegExp.exec(theRel))?true:false;pp_images=pp_titles=pp_descriptions=[];set_position=0;rel_index=0;var $this=$(this);function open_lightbox(){if(pp_images.length>settings.overlay_gallery_max)settings.overlay_gallery=false;set_position=jQuery.inArray($this.attr('href'),pp_images);rel_index=(isSet)?set_position:$("a["+settings.hook+"^='"+theRel+"']").index($this);_build_overlay($this[0]);if(settings.allow_resize)
$(window).bind('scroll.prettyphoto',function(){_center_overlay();});$.prettyPhoto.open();}
if(settings.gallery_url){if(isLoading==false){isLoading=true;$j.ajax({url:settings.gallery_url,dataType:'json',success:function(data){isLoading=false;pp_images=data.images;pp_titles=data.titles;pp_descriptions=data.descriptions;open_lightbox();}});}}else{pp_images=(isSet)?jQuery.map(matchedObjects,function(n,i){if($(n).attr(settings.hook).indexOf(theRel)!=-1)return $(n).attr('href');}):$.makeArray($(this).attr('href'));pp_titles=(isSet)?jQuery.map(matchedObjects,function(n,i){if($(n).attr(settings.hook).indexOf(theRel)!=-1)return($(n).find('img').attr('alt'))?$(n).find('img').attr('alt'):"";}):$.makeArray($(this).find('img').attr('alt'));pp_descriptions=(isSet)?jQuery.map(matchedObjects,function(n,i){if($(n).attr(settings.hook).indexOf(theRel)!=-1)return($(n).attr('title'))?$(n).attr('title'):"";}):$.makeArray($(this).attr('title'));open_lightbox();}
return false;}
$.prettyPhoto.open=function(event){if(typeof settings=="undefined"){settings=pp_settings;if($.browser.msie&&$.browser.version==6)settings.theme="light_square";pp_images=$.makeArray(arguments[0]);pp_titles=(arguments[1])?$.makeArray(arguments[1]):$.makeArray("");pp_descriptions=(arguments[2])?$.makeArray(arguments[2]):$.makeArray("");isSet=(pp_images.length>1)?true:false;set_position=(arguments[3])?arguments[3]:0;_build_overlay(event.target);}
if($.browser.msie&&$.browser.version==6)$('select').css('visibility','hidden');if(settings.hideflash)$('object,embed,iframe[src*=youtube],iframe[src*=vimeo]').css('visibility','hidden');_checkPosition($(pp_images).size());$('.pp_loaderIcon').show();if(settings.deeplinking)
setHashtag();if(settings.social_tools){facebook_like_link=settings.social_tools.replace('{location_href}',encodeURIComponent(location.href));$pp_pic_holder.find('.pp_social').html(facebook_like_link);}
if($ppt.is(':hidden'))$ppt.css('opacity',0).show();$pp_overlay.show().fadeTo(settings.animation_speed,settings.opacity);$pp_pic_holder.find('.currentTextHolder').text((set_position+1)+settings.counter_separator_label+$(pp_images).size());if(typeof pp_descriptions[set_position]!='undefined'&&pp_descriptions[set_position]!=""){$pp_pic_holder.find('.pp_description').show().html(unescape(pp_descriptions[set_position]));}else{$pp_pic_holder.find('.pp_description').hide();}
movie_width=(parseFloat(getParam('width',pp_images[set_position])))?getParam('width',pp_images[set_position]):settings.default_width.toString();movie_height=(parseFloat(getParam('height',pp_images[set_position])))?getParam('height',pp_images[set_position]):settings.default_height.toString();percentBased=false;if(movie_height.indexOf('%')!=-1){movie_height=parseFloat(($(window).height()*parseFloat(movie_height)/100)-150);percentBased=true;}
if(movie_width.indexOf('%')!=-1){movie_width=parseFloat(($(window).width()*parseFloat(movie_width)/100)-150);percentBased=true;}
$pp_pic_holder.fadeIn(function(){(settings.show_title&&pp_titles[set_position]!=""&&typeof pp_titles[set_position]!="undefined")?$ppt.find('span').html(unescape(pp_titles[set_position])):$ppt.find('span').html('&nbsp;');imgPreloader="";skipInjection=false;switch(_getFileType(pp_images[set_position])){case'image':imgPreloader=new Image();nextImage=new Image();if(isSet&&set_position<$(pp_images).size()-1)nextImage.src=pp_images[set_position+1];prevImage=new Image();if(isSet&&pp_images[set_position-1])prevImage.src=pp_images[set_position-1];$pp_pic_holder.find('#pp_full_res')[0].innerHTML=settings.image_markup.replace(/{path}/g,pp_images[set_position]);imgPreloader.onload=function(){pp_dimensions=_fitToViewport(imgPreloader.width,imgPreloader.height);_showContent();};imgPreloader.onerror=function(){alert('Image cannot be loaded. Make sure the path is correct and image exist.');$.prettyPhoto.close();};imgPreloader.src=pp_images[set_position];break;case'youtube':pp_dimensions=_fitToViewport(movie_width,movie_height);movie_id=getParam('v',pp_images[set_position]);if(movie_id==""){movie_id=pp_images[set_position].split('youtu.be/');movie_id=movie_id[1];if(movie_id.indexOf('?')>0)
movie_id=movie_id.substr(0,movie_id.indexOf('?'));if(movie_id.indexOf('&')>0)
movie_id=movie_id.substr(0,movie_id.indexOf('&'));}
movie='http://www.youtube.com/embed/'+movie_id;(getParam('rel',pp_images[set_position]))?movie+="?rel="+getParam('rel',pp_images[set_position]):movie+="?rel=1";if(settings.autoplay)movie+="&autoplay=1";toInject=settings.iframe_markup.replace(/{width}/g,pp_dimensions['width']).replace(/{height}/g,pp_dimensions['height']).replace(/{wmode}/g,settings.wmode).replace(/{path}/g,movie);break;case'vimeo':pp_dimensions=_fitToViewport(movie_width,movie_height);movie_id=pp_images[set_position];var regExp=/http:\/\/(www\.)?vimeo.com\/(\d+)/;var match=movie_id.match(regExp);movie='http://player.vimeo.com/video/'+match[2]+'?title=0&amp;byline=0&amp;portrait=0';if(settings.autoplay)movie+="&autoplay=1;";vimeo_width=pp_dimensions['width']+'/embed/?moog_width='+pp_dimensions['width'];toInject=settings.iframe_markup.replace(/{width}/g,vimeo_width).replace(/{height}/g,pp_dimensions['height']).replace(/{path}/g,movie);break;case'quicktime':pp_dimensions=_fitToViewport(movie_width,movie_height);pp_dimensions['height']+=15;pp_dimensions['contentHeight']+=15;pp_dimensions['containerHeight']+=15;toInject=settings.quicktime_markup.replace(/{width}/g,pp_dimensions['width']).replace(/{height}/g,pp_dimensions['height']).replace(/{wmode}/g,settings.wmode).replace(/{path}/g,pp_images[set_position]).replace(/{autoplay}/g,settings.autoplay);break;case'flash':pp_dimensions=_fitToViewport(movie_width,movie_height);flash_vars=pp_images[set_position];flash_vars=flash_vars.substring(pp_images[set_position].indexOf('flashvars')+10,pp_images[set_position].length);filename=pp_images[set_position];filename=filename.substring(0,filename.indexOf('?'));toInject=settings.flash_markup.replace(/{width}/g,pp_dimensions['width']).replace(/{height}/g,pp_dimensions['height']).replace(/{wmode}/g,settings.wmode).replace(/{path}/g,filename+'?'+flash_vars);break;case'iframe':pp_dimensions=_fitToViewport(movie_width,movie_height);frame_url=pp_images[set_position];frame_url=frame_url.substr(0,frame_url.indexOf('iframe')-1);toInject=settings.iframe_markup.replace(/{width}/g,pp_dimensions['width']).replace(/{height}/g,pp_dimensions['height']).replace(/{path}/g,frame_url);break;case'ajax':doresize=false;pp_dimensions=_fitToViewport(movie_width,movie_height);doresize=true;skipInjection=true;$.get(pp_images[set_position],function(responseHTML){toInject=settings.inline_markup.replace(/{content}/g,responseHTML);$pp_pic_holder.find('#pp_full_res')[0].innerHTML=toInject;_showContent();});break;case'custom':pp_dimensions=_fitToViewport(movie_width,movie_height);toInject=settings.custom_markup;break;case'inline':myClone=$(pp_images[set_position]).clone().append('<br clear="all" />').css({'width':settings.default_width}).wrapInner('<div id="pp_full_res"><div class="pp_inline"></div></div>').appendTo($('body')).show();doresize=false;pp_dimensions=_fitToViewport($(myClone).width(),$(myClone).height());doresize=true;$(myClone).remove();toInject=settings.inline_markup.replace(/{content}/g,$(pp_images[set_position]).html());break;};if(!imgPreloader&&!skipInjection){$pp_pic_holder.find('#pp_full_res')[0].innerHTML=toInject;_showContent();};});return false;};$.prettyPhoto.changePage=function(direction){currentGalleryPage=0;if(direction=='previous'){set_position--;if(set_position<0)set_position=$(pp_images).size()-1;}else if(direction=='next'){set_position++;if(set_position>$(pp_images).size()-1)set_position=0;}else{set_position=direction;};rel_index=set_position;if(!doresize)doresize=true;if(settings.allow_expand){$('.pp_contract').removeClass('pp_contract').addClass('pp_expand');}
_hideContent(function(){$.prettyPhoto.open();});};$.prettyPhoto.changeGalleryPage=function(direction){if(direction=='next'){currentGalleryPage++;if(currentGalleryPage>totalPage)currentGalleryPage=0;}else if(direction=='previous'){currentGalleryPage--;if(currentGalleryPage<0)currentGalleryPage=totalPage;}else{currentGalleryPage=direction;};slide_speed=(direction=='next'||direction=='previous')?settings.animation_speed:0;slide_to=currentGalleryPage*(itemsPerPage*itemWidth);$pp_gallery.find('ul').animate({left:-slide_to},slide_speed);};$.prettyPhoto.startSlideshow=function(){if(typeof pp_slideshow=='undefined'){$pp_pic_holder.find('.pp_play').unbind('click').removeClass('pp_play').addClass('pp_pause').click(function(){$.prettyPhoto.stopSlideshow();return false;});pp_slideshow=setInterval($.prettyPhoto.startSlideshow,settings.slideshow);}else{$.prettyPhoto.changePage('next');};}
$.prettyPhoto.stopSlideshow=function(){$pp_pic_holder.find('.pp_pause').unbind('click').removeClass('pp_pause').addClass('pp_play').click(function(){$.prettyPhoto.startSlideshow();return false;});clearInterval(pp_slideshow);pp_slideshow=undefined;}
$.prettyPhoto.close=function(){if($pp_overlay.is(":animated"))return;$.prettyPhoto.stopSlideshow();$pp_pic_holder.stop().find('object,embed').css('visibility','hidden');$('div.pp_pic_holder,div.ppt,.pp_fade').fadeOut(settings.animation_speed,function(){$(this).remove();});$pp_overlay.fadeOut(settings.animation_speed,function(){if($.browser.msie&&$.browser.version==6)$('select').css('visibility','visible');if(settings.hideflash)$('object,embed,iframe[src*=youtube],iframe[src*=vimeo]').css('visibility','visible');$(this).remove();$(window).unbind('scroll.prettyphoto');clearHashtag();if($.isFunction(settings.callback))settings.callback();doresize=true;pp_open=false;delete settings;});};function _showContent(){$('.pp_loaderIcon').hide();projectedTop=scroll_pos['scrollTop']+((windowHeight/2)-(pp_dimensions['containerHeight']/2));if(projectedTop<0)projectedTop=0;$ppt.fadeTo(settings.animation_speed,1);$pp_pic_holder.find('.pp_content').animate({height:pp_dimensions['contentHeight'],width:pp_dimensions['contentWidth']},settings.animation_speed);$pp_pic_holder.animate({'top':projectedTop,'left':((windowWidth/2)-(pp_dimensions['containerWidth']/2)<0)?0:(windowWidth/2)-(pp_dimensions['containerWidth']/2),width:pp_dimensions['containerWidth']},settings.animation_speed,function(){$pp_pic_holder.find('.pp_hoverContainer,#fullResImage').height(pp_dimensions['height']).width(pp_dimensions['width']);$pp_pic_holder.find('.pp_fade').fadeIn(settings.animation_speed);if(isSet&&_getFileType(pp_images[set_position])=="image"){$pp_pic_holder.find('.pp_hoverContainer').show();}else{$pp_pic_holder.find('.pp_hoverContainer').hide();}
if(settings.allow_expand){if(pp_dimensions['resized']){$('a.pp_expand,a.pp_contract').show();}else{$('a.pp_expand').hide();}}
if(settings.autoplay_slideshow&&!pp_slideshow&&!pp_open)$.prettyPhoto.startSlideshow();if($.isFunction(settings.changepicturecallback))settings.changepicturecallback();pp_open=true;});_insert_gallery();if($.isFunction(pp_settings.ajaxcallback))pp_settings.ajaxcallback();};function _hideContent(callback){$pp_pic_holder.find('#pp_full_res object,#pp_full_res embed').css('visibility','hidden');$pp_pic_holder.find('.pp_fade').fadeOut(settings.animation_speed,function(){$('.pp_loaderIcon').show();if($.isFunction(callback))callback();});};function _checkPosition(setCount){(setCount>1)?$('.pp_nav').show():$('.pp_nav').hide();};function _fitToViewport(width,height){resized=false;_getDimensions(width,height);imageWidth=width,imageHeight=height;if(((pp_containerWidth>windowWidth)||(pp_containerHeight>windowHeight))&&doresize&&settings.allow_resize&&!percentBased){resized=true,fitting=false;while(!fitting){if((pp_containerWidth>windowWidth)){imageWidth=(windowWidth-200);imageHeight=(height/width)*imageWidth;}else if((pp_containerHeight>windowHeight)){imageHeight=(windowHeight-200);imageWidth=(width/height)*imageHeight;}else{fitting=true;};pp_containerHeight=imageHeight,pp_containerWidth=imageWidth;};_getDimensions(imageWidth,imageHeight);if((pp_containerWidth>windowWidth)||(pp_containerHeight>windowHeight)){_fitToViewport(pp_containerWidth,pp_containerHeight)};};return{width:Math.floor(imageWidth),height:Math.floor(imageHeight),containerHeight:Math.floor(pp_containerHeight),containerWidth:Math.floor(pp_containerWidth)+(settings.horizontal_padding*2),contentHeight:Math.floor(pp_contentHeight),contentWidth:Math.floor(pp_contentWidth),resized:resized};};function _getDimensions(width,height){width=parseFloat(width);height=parseFloat(height);$pp_details=$pp_pic_holder.find('.pp_details');$pp_details.width(width);detailsHeight=parseFloat($pp_details.css('marginTop'))+parseFloat($pp_details.css('marginBottom'));$pp_details=$pp_details.clone().addClass(settings.theme).width(width).appendTo($('body')).css({'position':'absolute','top':-10000});detailsHeight+=$pp_details.height();detailsHeight=(detailsHeight<=34)?36:detailsHeight;if($.browser.msie&&$.browser.version==7)detailsHeight+=8;$pp_details.remove();$pp_title=$pp_pic_holder.find('.ppt');titleHeight=parseFloat($pp_title.css('marginTop'))+parseFloat($pp_title.css('marginBottom'));$pp_title=$pp_title.clone().appendTo($('body')).css({'position':'absolute','top':-10000});titleHeight+=$pp_title.height();$pp_title.remove();pp_contentHeight=height+detailsHeight;pp_contentWidth=width;pp_containerHeight=pp_contentHeight+titleHeight+$pp_pic_holder.find('.pp_top').height()+$pp_pic_holder.find('.pp_bottom').height();pp_containerWidth=width;}
function _getFileType(itemSrc){if(itemSrc.match(/youtube\.com\/watch/i)||itemSrc.match(/youtu\.be/i)){return'youtube';}else if(itemSrc.match(/vimeo\.com/i)){return'vimeo';}else if(itemSrc.match(/\b.mov\b/i)){return'quicktime';}else if(itemSrc.match(/\b.swf\b/i)){return'flash';}else if(itemSrc.match(/\biframe=true\b/i)){return'iframe';}else if(itemSrc.match(/\bajax=true\b/i)){return'ajax';}else if(itemSrc.match(/\bcustom=true\b/i)){return'custom';}else if(itemSrc.substr(0,1)=='#'){return'inline';}else{return'image';};};function _center_overlay(){if(doresize&&typeof $pp_pic_holder!='undefined'){scroll_pos=_get_scroll();contentHeight=$pp_pic_holder.height(),contentwidth=$pp_pic_holder.width();projectedTop=(windowHeight/2)+scroll_pos['scrollTop']-(contentHeight/2);if(projectedTop<0)projectedTop=0;if(contentHeight>windowHeight)
return;$pp_pic_holder.css({'top':projectedTop,'left':(windowWidth/2)+scroll_pos['scrollLeft']-(contentwidth/2)});};};function _get_scroll(){if(self.pageYOffset){return{scrollTop:self.pageYOffset,scrollLeft:self.pageXOffset};}else if(document.documentElement&&document.documentElement.scrollTop){return{scrollTop:document.documentElement.scrollTop,scrollLeft:document.documentElement.scrollLeft};}else if(document.body){return{scrollTop:document.body.scrollTop,scrollLeft:document.body.scrollLeft};};};function _resize_overlay(){windowHeight=$(window).height(),windowWidth=$(window).width();if(typeof $pp_overlay!="undefined")$pp_overlay.height($(document).height()).width(windowWidth);};function _insert_gallery(){if(isSet&&settings.overlay_gallery&&_getFileType(pp_images[set_position])=="image"&&(settings.ie6_fallback&&!($.browser.msie&&parseInt($.browser.version)==6))){itemWidth=52+5;navWidth=(settings.theme=="facebook"||settings.theme=="pp_default")?50:30;itemsPerPage=Math.floor((pp_dimensions['containerWidth']-100-navWidth)/itemWidth);itemsPerPage=(itemsPerPage<pp_images.length)?itemsPerPage:pp_images.length;totalPage=Math.ceil(pp_images.length/itemsPerPage)-1;if(totalPage==0){navWidth=0;$pp_gallery.find('.pp_arrow_next,.pp_arrow_previous').hide();}else{$pp_gallery.find('.pp_arrow_next,.pp_arrow_previous').show();};galleryWidth=itemsPerPage*itemWidth;fullGalleryWidth=pp_images.length*itemWidth;$pp_gallery.css('margin-left',-((galleryWidth/2)+(navWidth/2))).find('div:first').width(galleryWidth+5).find('ul').width(fullGalleryWidth).find('li.selected').removeClass('selected');goToPage=(Math.floor(set_position/itemsPerPage)<totalPage)?Math.floor(set_position/itemsPerPage):totalPage;$.prettyPhoto.changeGalleryPage(goToPage);$pp_gallery_li.filter(':eq('+set_position+')').addClass('selected');}else{$pp_pic_holder.find('.pp_content').unbind('mouseenter mouseleave');}}
function _build_overlay(caller){if(settings.social_tools)
facebook_like_link=settings.social_tools.replace('{location_href}',encodeURIComponent(location.href));settings.markup=settings.markup.replace('{pp_social}','');$('body').append(settings.markup);$pp_pic_holder=$('.pp_pic_holder'),$ppt=$('.ppt'),$pp_overlay=$('div.pp_overlay');if(isSet&&settings.overlay_gallery){currentGalleryPage=0;toInject="";for(var i=0;i<pp_images.length;i++){if(!pp_images[i].match(/\b(jpg|jpeg|png|gif)\b/gi)){classname='default';img_src='';}else{classname='';img_src=pp_images[i];}
toInject+="<li class='"+classname+"'><a href='#'><img src='"+img_src+"' width='50' alt='' /></a></li>";};toInject=settings.gallery_markup.replace(/{gallery}/g,toInject);$pp_pic_holder.find('#pp_full_res').after(toInject);$pp_gallery=$('.pp_pic_holder .pp_gallery'),$pp_gallery_li=$pp_gallery.find('li');$pp_gallery.find('.pp_arrow_next').click(function(){$.prettyPhoto.changeGalleryPage('next');$.prettyPhoto.stopSlideshow();return false;});$pp_gallery.find('.pp_arrow_previous').click(function(){$.prettyPhoto.changeGalleryPage('previous');$.prettyPhoto.stopSlideshow();return false;});$pp_pic_holder.find('.pp_content').hover(function(){$pp_pic_holder.find('.pp_gallery:not(.disabled)').fadeIn();},function(){$pp_pic_holder.find('.pp_gallery:not(.disabled)').fadeOut();});itemWidth=52+5;$pp_gallery_li.each(function(i){$(this).find('a').click(function(){$.prettyPhoto.changePage(i);$.prettyPhoto.stopSlideshow();return false;});});};if(settings.slideshow){$pp_pic_holder.find('.pp_nav').prepend('<a href="#" class="pp_play">Play</a>')
$pp_pic_holder.find('.pp_nav .pp_play').click(function(){$.prettyPhoto.startSlideshow();return false;});}
$pp_pic_holder.attr('class','pp_pic_holder '+settings.theme);$pp_overlay.css({'opacity':0,'height':$(document).height(),'width':$(window).width()}).bind('click',function(){if(!settings.modal)$.prettyPhoto.close();});$('a.pp_close').bind('click',function(){$.prettyPhoto.close();return false;});if(settings.allow_expand){$('a.pp_expand').bind('click',function(e){if($(this).hasClass('pp_expand')){$(this).removeClass('pp_expand').addClass('pp_contract');doresize=false;}else{$(this).removeClass('pp_contract').addClass('pp_expand');doresize=true;};_hideContent(function(){$.prettyPhoto.open();});return false;});}
$pp_pic_holder.find('.pp_previous, .pp_nav .pp_arrow_previous').bind('click',function(){$.prettyPhoto.changePage('previous');$.prettyPhoto.stopSlideshow();return false;});$pp_pic_holder.find('.pp_next, .pp_nav .pp_arrow_next').bind('click',function(){$.prettyPhoto.changePage('next');$.prettyPhoto.stopSlideshow();return false;});_center_overlay();};if(!pp_alreadyInitialized&&getHashtag()){pp_alreadyInitialized=true;hashIndex=getHashtag();hashRel=hashIndex;hashIndex=hashIndex.substring(hashIndex.indexOf('/')+1,hashIndex.length-1);hashRel=hashRel.substring(0,hashRel.indexOf('/'));setTimeout(function(){$("a["+pp_settings.hook+"^='"+hashRel+"']:eq("+hashIndex+")").trigger('click');},50);}
return this.unbind('click.prettyphoto').bind('click.prettyphoto',$.prettyPhoto.initialize);};function getHashtag(){url=location.href;hashtag=(url.indexOf('#prettyPhoto')!==-1)?decodeURI(url.substring(url.indexOf('#prettyPhoto')+1,url.length)):false;return hashtag;};function setHashtag(){if(typeof theRel=='undefined')return;location.hash=theRel+'/'+rel_index+'/';};function clearHashtag(){if(location.href.indexOf('#prettyPhoto')!==-1)location.hash="prettyPhoto";}
function getParam(name,url){name=name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regexS="[\\?&]"+name+"=([^&#]*)";var regex=new RegExp(regexS);var results=regex.exec(url);return(results==null)?"":results[1];}})(jQuery);var pp_alreadyInitialized=false;(function($){var undef,window=this,doc=window.document,$doc=$(doc),$win=$(window),protoArray=Array.prototype,VERSION=1.27,DEBUG=true,TIMEOUT=30000,DUMMY=false,NAV=navigator.userAgent.toLowerCase(),HASH=window.location.hash.replace(/#\//,''),F=function(){},FALSE=function(){return false;},IE=(function(){var v=3,div=doc.createElement('div'),all=div.getElementsByTagName('i');do{div.innerHTML='<!--[if gt IE '+(++v)+']><i></i><![endif]-->';}while(all[0]);return v>4?v:undef;}()),DOM=function(){return{html:doc.documentElement,body:doc.body,head:doc.getElementsByTagName('head')[0],title:doc.title};},_eventlist='data ready thumbnail loadstart loadfinish image play pause progress '+'fullscreen_enter fullscreen_exit idle_enter idle_exit rescale '+'lightbox_open lightbox_close lightbox_image',_events=(function(){var evs=[];$.each(_eventlist.split(' '),function(i,ev){evs.push(ev);if(/_/.test(ev)){evs.push(ev.replace(/_/g,''));}});return evs;}()),_legacyOptions=function(options){var n;if(typeof options!=='object'){return options;}
$.each(options,function(key,value){if(/^[a-z]+_/.test(key)){n='';$.each(key.split('_'),function(i,k){n+=i>0?k.substr(0,1).toUpperCase()+k.substr(1):k;});options[n]=value;delete options[key];}});return options;},_patchEvent=function(type){if($.inArray(type,_events)>-1){return Galleria[type.toUpperCase()];}
return type;},_video={youtube:{reg:/https?:\/\/(?:[a-zA_Z]{2,3}.)?(?:youtube\.com\/watch\?)((?:[\w\d\-\_\=]+&amp;(?:amp;)?)*v(?:&lt;[A-Z]+&gt;)?=([0-9a-zA-Z\-\_]+))/i,embed:function(id){return'http://www.youtube.com/embed/'+id;},getThumb:function(id,success,fail){fail=fail||F;$.getJSON('http://gdata.youtube.com/feeds/api/videos/'+id+'?v=2&alt=json-in-script&callback=?',function(data){try{success(data.entry.media$group.media$thumbnail[0].url);}catch(e){fail();}}).error(fail);}},vimeo:{reg:/https?:\/\/(?:www\.)?(vimeo\.com)\/(?:hd#)?([0-9]+)/i,embed:function(id){return'http://player.vimeo.com/video/'+id;},getThumb:function(id,success,fail){fail=fail||F;$.getJSON('http://vimeo.com/api/v2/video/'+id+'.json?callback=?',function(data){try{success(data[0].thumbnail_medium);}catch(e){fail();}}).error(fail);}},dailymotion:{reg:/https?:\/\/(?:www\.)?(dailymotion\.com)\/video\/([^_]+)/,embed:function(id){return'http://www.dailymotion.com/embed/video/'+id;},getThumb:function(id,success,fail){fail=fail||F;$.getJSON('https://api.dailymotion.com/video/'+id+'?fields=thumbnail_medium_url&callback=?',function(data){try{success(data.thumbnail_medium_url);}catch(e){fail();}}).error(fail);}}},_videoTest=function(url){var match;for(var v in _video){match=url&&url.match(_video[v].reg);if(match&&match.length){return{id:match[2],provider:v};}}
return false;},_timeouts={trunk:{},add:function(id,fn,delay,loop){id=id||new Date().getTime();loop=loop||false;this.clear(id);if(loop){var old=fn;fn=function(){old();_timeouts.add(id,fn,delay);};}
this.trunk[id]=window.setTimeout(fn,delay);},clear:function(id){var del=function(i){window.clearTimeout(this.trunk[i]);delete this.trunk[i];},i;if(!!id&&id in this.trunk){del.call(_timeouts,id);}else if(typeof id==='undefined'){for(i in this.trunk){if(this.trunk.hasOwnProperty(i)){del.call(_timeouts,i);}}}}},_galleries=[],_instances=[],_hasError=false,_canvas=false,_pool=[],_themeLoad=function(theme){Galleria.theme=theme;$.each(_pool,function(i,instance){if(!instance._initialized){instance._init.call(instance);}});},Utils=(function(){return{array:function(obj){return protoArray.slice.call(obj,0);},create:function(className,nodeName){nodeName=nodeName||'div';var elem=doc.createElement(nodeName);elem.className=className;return elem;},getScriptPath:function(src){src=src||$('script:last').attr('src');var slices=src.split('/');if(slices.length==1){return'';}
slices.pop();return slices.join('/')+'/';},animate:(function(){var transition=(function(style){var props='transition WebkitTransition MozTransition OTransition'.split(' '),i;if(window.opera){return false;}
for(i=0;props[i];i++){if(typeof style[props[i]]!=='undefined'){return props[i];}}
return false;}((doc.body||doc.documentElement).style));var endEvent={MozTransition:'transitionend',OTransition:'oTransitionEnd',WebkitTransition:'webkitTransitionEnd',transition:'transitionend'}[transition];var easings={_default:[0.25,0.1,0.25,1],galleria:[0.645,0.045,0.355,1],galleriaIn:[0.55,0.085,0.68,0.53],galleriaOut:[0.25,0.46,0.45,0.94],ease:[0.25,0,0.25,1],linear:[0.25,0.25,0.75,0.75],'ease-in':[0.42,0,1,1],'ease-out':[0,0,0.58,1],'ease-in-out':[0.42,0,0.58,1]};var setStyle=function(elem,value,suffix){var css={};suffix=suffix||'transition';$.each('webkit moz ms o'.split(' '),function(){css['-'+this+'-'+suffix]=value;});elem.css(css);};var clearStyle=function(elem){setStyle(elem,'none','transition');if(Galleria.WEBKIT&&Galleria.TOUCH){setStyle(elem,'translate3d(0,0,0)','transform');if(elem.data('revert')){elem.css(elem.data('revert'));elem.data('revert',null);}}};var change,strings,easing,syntax,revert,form,css;return function(elem,to,options){options=$.extend({duration:400,complete:F,stop:false},options);elem=$(elem);if(!options.duration){elem.css(to);options.complete.call(elem[0]);return;}
if(!transition){elem.animate(to,options);return;}
if(options.stop){elem.unbind(endEvent);clearStyle(elem);}
change=false;$.each(to,function(key,val){css=elem.css(key);if(Utils.parseValue(css)!=Utils.parseValue(val)){change=true;}
elem.css(key,css);});if(!change){window.setTimeout(function(){options.complete.call(elem[0]);},options.duration);return;}
strings=[];easing=options.easing in easings?easings[options.easing]:easings._default;syntax=' '+options.duration+'ms'+' cubic-bezier('+easing.join(',')+')';window.setTimeout((function(elem,endEvent,to,syntax){return function(){elem.one(endEvent,(function(elem){return function(){clearStyle(elem);options.complete.call(elem[0]);};}(elem)));if(Galleria.WEBKIT&&Galleria.TOUCH){revert={};form=[0,0,0];$.each(['left','top'],function(i,m){if(m in to){form[i]=(Utils.parseValue(to[m])-Utils.parseValue(elem.css(m)))+'px';revert[m]=to[m];delete to[m];}});if(form[0]||form[1]){elem.data('revert',revert);strings.push('-webkit-transform'+syntax);setStyle(elem,'translate3d('+form.join(',')+')','transform');}}
$.each(to,function(p,val){strings.push(p+syntax);});setStyle(elem,strings.join(','));elem.css(to);};}(elem,endEvent,to,syntax)),2);};}()),removeAlpha:function(elem){if(IE<9&&elem){var style=elem.style,currentStyle=elem.currentStyle,filter=currentStyle&&currentStyle.filter||style.filter||"";if(/alpha/.test(filter)){style.filter=filter.replace(/alpha\([^)]*\)/i,'');}}},forceStyles:function(elem,styles){elem=$(elem);if(elem.attr('style')){elem.data('styles',elem.attr('style')).removeAttr('style');}
elem.css(styles);},revertStyles:function(){$.each(Utils.array(arguments),function(i,elem){elem=$(elem);elem.removeAttr('style');elem.attr('style','');if(elem.data('styles')){elem.attr('style',elem.data('styles')).data('styles',null);}});},moveOut:function(elem){Utils.forceStyles(elem,{position:'absolute',left:-10000});},moveIn:function(){Utils.revertStyles.apply(Utils,Utils.array(arguments));},elem:function(elem){if(elem instanceof $){return{$:elem,dom:elem[0]};}else{return{$:$(elem),dom:elem};}},hide:function(elem,speed,callback){callback=callback||F;var el=Utils.elem(elem),$elem=el.$;elem=el.dom;if(!$elem.data('opacity')){$elem.data('opacity',$elem.css('opacity'));}
var style={opacity:0};if(speed){var complete=IE<9&&elem?function(){Utils.removeAlpha(elem);elem.style.visibility='hidden';callback.call(elem);}:callback;Utils.animate(elem,style,{duration:speed,complete:complete,stop:true});}else{if(IE<9&&elem){Utils.removeAlpha(elem);elem.style.visibility='hidden';}else{$elem.css(style);}}},show:function(elem,speed,callback){callback=callback||F;var el=Utils.elem(elem),$elem=el.$;elem=el.dom;var saved=parseFloat($elem.data('opacity'))||1,style={opacity:saved};if(speed){if(IE<9){$elem.css('opacity',0);elem.style.visibility='visible';}
var complete=IE<9&&elem?function(){if(style.opacity==1){Utils.removeAlpha(elem);}
callback.call(elem);}:callback;Utils.animate(elem,style,{duration:speed,complete:complete,stop:true});}else{if(IE<9&&style.opacity==1&&elem){Utils.removeAlpha(elem);elem.style.visibility='visible';}else{$elem.css(style);}}},optimizeTouch:(function(){var node,evs,fakes,travel,evt={},handler=function(e){e.preventDefault();evt=$.extend({},e,true);},attach=function(){this.evt=evt;},fake=function(){this.handler.call(node,this.evt);};return function(elem){$(elem).bind('touchend',function(e){node=e.target;travel=true;while(node.parentNode&&node!=e.currentTarget&&travel){evs=$(node).data('events');fakes=$(node).data('fakes');if(evs&&'click'in evs){travel=false;e.preventDefault();$(node).click(handler).click();evs.click.pop();$.each(evs.click,attach);$(node).data('fakes',evs.click);delete evs.click;}else if(fakes){travel=false;e.preventDefault();$.each(fakes,fake);}
node=node.parentNode;}});};}()),addTimer:function(){_timeouts.add.apply(_timeouts,Utils.array(arguments));return this;},clearTimer:function(){_timeouts.clear.apply(_timeouts,Utils.array(arguments));return this;},wait:function(options){options=$.extend({until:FALSE,success:F,error:function(){Galleria.raise('Could not complete wait function.');},timeout:3000},options);var start=Utils.timestamp(),elapsed,now,fn=function(){now=Utils.timestamp();elapsed=now-start;if(options.until(elapsed)){options.success();return false;}
if(typeof options.timeout=='number'&&now>=start+options.timeout){options.error();return false;}
window.setTimeout(fn,10);};window.setTimeout(fn,10);},toggleQuality:function(img,force){if((IE!==7&&IE!==8)||!img||img.nodeName.toUpperCase()!='IMG'){return;}
if(typeof force==='undefined'){force=img.style.msInterpolationMode==='nearest-neighbor';}
img.style.msInterpolationMode=force?'bicubic':'nearest-neighbor';},insertStyleTag:function(styles){var style=doc.createElement('style');DOM().head.appendChild(style);if(style.styleSheet){style.styleSheet.cssText=styles;}else{var cssText=doc.createTextNode(styles);style.appendChild(cssText);}},loadScript:function(url,callback){var done=false,script=$('<scr'+'ipt>').attr({src:url,async:true}).get(0);script.onload=script.onreadystatechange=function(){if(!done&&(!this.readyState||this.readyState==='loaded'||this.readyState==='complete')){done=true;script.onload=script.onreadystatechange=null;if(typeof callback==='function'){callback.call(this,this);}}};DOM().head.appendChild(script);},parseValue:function(val){if(typeof val==='number'){return val;}else if(typeof val==='string'){var arr=val.match(/\-?\d|\./g);return arr&&arr.constructor===Array?arr.join('')*1:0;}else{return 0;}},timestamp:function(){return new Date().getTime();},loadCSS:function(href,id,callback){var link,ready=false,length,lastChance=function(){var fake=new Image();fake.onload=fake.onerror=function(e){fake=null;ready=true;};fake.src=href;};$('link[rel=stylesheet]').each(function(){if(new RegExp(href).test(this.href)){link=this;return false;}});if(typeof id==='function'){callback=id;id=undef;}
callback=callback||F;if(link){callback.call(link,link);return link;}
length=doc.styleSheets.length;if($('#'+id).length){$('#'+id).attr('href',href);length--;ready=true;}else{link=$('<link>').attr({rel:'stylesheet',href:href,id:id}).get(0);window.setTimeout(function(){var styles=$('link[rel="stylesheet"], style');if(styles.length){styles.get(0).parentNode.insertBefore(link,styles[0]);}else{DOM().head.appendChild(link);}
if(IE){if(length>=31){Galleria.raise('You have reached the browser stylesheet limit (31)',true);return;}
link.onreadystatechange=function(e){if(!ready&&(!this.readyState||this.readyState==='loaded'||this.readyState==='complete')){ready=true;}};}else{var dum=doc.createElement('a'),loc=window.location;dum.href=href;if(!(/file/.test(loc.protocol))&&loc.hostname==dum.hostname&&loc.port==dum.port&&loc.protocol==dum.protocol){$.ajax({url:href,success:function(){ready=true;},error:lastChance});}else{lastChance();}}},10);}
if(typeof callback==='function'){Utils.wait({until:function(){return ready&&doc.styleSheets.length>length;},success:function(){window.setTimeout(function(){callback.call(link,link);},100);},error:function(){Galleria.raise('Theme CSS could not load',true);},timeout:10000});}
return link;}};}()),_transitions=(function(){var _slide=function(params,complete,fade,door){var easing=this.getOptions('easing'),distance=this.getStageWidth(),from={left:distance*(params.rewind?-1:1)},to={left:0};if(fade){from.opacity=0;to.opacity=1;}else{from.opacity=1;}
$(params.next).css(from);Utils.animate(params.next,to,{duration:params.speed,complete:(function(elems){return function(){complete();elems.css({left:0});};}($(params.next).add(params.prev))),queue:false,easing:easing});if(door){params.rewind=!params.rewind;}
if(params.prev){from={left:0};to={left:distance*(params.rewind?1:-1)};if(fade){from.opacity=1;to.opacity=0;}
$(params.prev).css(from);Utils.animate(params.prev,to,{duration:params.speed,queue:false,easing:easing,complete:function(){$(this).css('opacity',0);}});}};return{fade:function(params,complete){$(params.next).css({opacity:0,left:0}).show();Utils.animate(params.next,{opacity:1},{duration:params.speed,complete:complete});if(params.prev){$(params.prev).css('opacity',1).show();Utils.animate(params.prev,{opacity:0},{duration:params.speed});}},flash:function(params,complete){$(params.next).css({opacity:0,left:0});if(params.prev){Utils.animate(params.prev,{opacity:0},{duration:params.speed/2,complete:function(){Utils.animate(params.next,{opacity:1},{duration:params.speed,complete:complete});}});}else{Utils.animate(params.next,{opacity:1},{duration:params.speed,complete:complete});}},pulse:function(params,complete){if(params.prev){$(params.prev).hide();}
$(params.next).css({opacity:0,left:0}).show();Utils.animate(params.next,{opacity:1},{duration:params.speed,complete:complete});},slide:function(params,complete){_slide.apply(this,Utils.array(arguments));},fadeslide:function(params,complete){_slide.apply(this,Utils.array(arguments).concat([true]));},doorslide:function(params,complete){_slide.apply(this,Utils.array(arguments).concat([false,true]));}};}());Galleria=function(){var self=this;this._options={};this._playing=false;this._playtime=5000;this._active=null;this._queue={length:0};this._data=[];this._dom={};this._thumbnails=[];this._layers=[];this._initialized=false;this._firstrun=false;this._stageWidth=0;this._stageHeight=0;this._target=undef;this._id=parseInt(Math.random()*10000,10);var divs='container stage images image-nav image-nav-left image-nav-right '+'info info-text info-title info-description '+'thumbnails thumbnails-list thumbnails-container thumb-nav-left thumb-nav-right '+'loader counter tooltip',spans='current total';$.each(divs.split(' '),function(i,elemId){self._dom[elemId]=Utils.create('galleria-'+elemId);});$.each(spans.split(' '),function(i,elemId){self._dom[elemId]=Utils.create('galleria-'+elemId,'span');});var keyboard=this._keyboard={keys:{'UP':38,'DOWN':40,'LEFT':37,'RIGHT':39,'RETURN':13,'ESCAPE':27,'BACKSPACE':8,'SPACE':32},map:{},bound:false,press:function(e){var key=e.keyCode||e.which;if(key in keyboard.map&&typeof keyboard.map[key]==='function'){keyboard.map[key].call(self,e);}},attach:function(map){var key,up;for(key in map){if(map.hasOwnProperty(key)){up=key.toUpperCase();if(up in keyboard.keys){keyboard.map[keyboard.keys[up]]=map[key];}else{keyboard.map[up]=map[key];}}}
if(!keyboard.bound){keyboard.bound=true;$doc.bind('keydown',keyboard.press);}},detach:function(){keyboard.bound=false;keyboard.map={};$doc.unbind('keydown',keyboard.press);}};var controls=this._controls={0:undef,1:undef,active:0,swap:function(){controls.active=controls.active?0:1;},getActive:function(){return controls[controls.active];},getNext:function(){return controls[1-controls.active];}};var carousel=this._carousel={next:self.$('thumb-nav-right'),prev:self.$('thumb-nav-left'),width:0,current:0,max:0,hooks:[],update:function(){var w=0,h=0,hooks=[0];$.each(self._thumbnails,function(i,thumb){if(thumb.ready){w+=thumb.outerWidth||$(thumb.container).outerWidth(true);hooks[i+1]=w;h=Math.max(h,thumb.outerHeight||$(thumb.container).outerHeight(true));}});self.$('thumbnails').css({width:w,height:h});carousel.max=w;carousel.hooks=hooks;carousel.width=self.$('thumbnails-list').width();carousel.setClasses();self.$('thumbnails-container').toggleClass('galleria-carousel',w>carousel.width);carousel.width=self.$('thumbnails-list').width();},bindControls:function(){var i;carousel.next.bind('click',function(e){e.preventDefault();if(self._options.carouselSteps==='auto'){for(i=carousel.current;i<carousel.hooks.length;i++){if(carousel.hooks[i]-carousel.hooks[carousel.current]>carousel.width){carousel.set(i-2);break;}}}else{carousel.set(carousel.current+self._options.carouselSteps);}});carousel.prev.bind('click',function(e){e.preventDefault();if(self._options.carouselSteps==='auto'){for(i=carousel.current;i>=0;i--){if(carousel.hooks[carousel.current]-carousel.hooks[i]>carousel.width){carousel.set(i+2);break;}else if(i===0){carousel.set(0);break;}}}else{carousel.set(carousel.current-self._options.carouselSteps);}});},set:function(i){i=Math.max(i,0);while(carousel.hooks[i-1]+carousel.width>=carousel.max&&i>=0){i--;}
carousel.current=i;carousel.animate();},getLast:function(i){return(i||carousel.current)-1;},follow:function(i){if(i===0||i===carousel.hooks.length-2){carousel.set(i);return;}
var last=carousel.current;while(carousel.hooks[last]-carousel.hooks[carousel.current]<carousel.width&&last<=carousel.hooks.length){last++;}
if(i-1<carousel.current){carousel.set(i-1);}else if(i+2>last){carousel.set(i-last+carousel.current+2);}},setClasses:function(){carousel.prev.toggleClass('disabled',!carousel.current);carousel.next.toggleClass('disabled',carousel.hooks[carousel.current]+carousel.width>=carousel.max);},animate:function(to){carousel.setClasses();var num=carousel.hooks[carousel.current]*-1;if(isNaN(num)){return;}
Utils.animate(self.get('thumbnails'),{left:num},{duration:self._options.carouselSpeed,easing:self._options.easing,queue:false});}};var tooltip=this._tooltip={initialized:false,open:false,timer:'tooltip'+self._id,swapTimer:'swap'+self._id,init:function(){tooltip.initialized=true;var css='.galleria-tooltip{padding:3px 8px;max-width:50%;background:#ffe;color:#000;z-index:3;position:absolute;font-size:11px;line-height:1.3'+'opacity:0;box-shadow:0 0 2px rgba(0,0,0,.4);-moz-box-shadow:0 0 2px rgba(0,0,0,.4);-webkit-box-shadow:0 0 2px rgba(0,0,0,.4);}';Utils.insertStyleTag(css);self.$('tooltip').css('opacity',0.8);Utils.hide(self.get('tooltip'));},move:function(e){var mouseX=self.getMousePosition(e).x,mouseY=self.getMousePosition(e).y,$elem=self.$('tooltip'),x=mouseX,y=mouseY,height=$elem.outerHeight(true)+1,width=$elem.outerWidth(true),limitY=height+15;var maxX=self.$('container').width()-width-2,maxY=self.$('container').height()-height-2;if(!isNaN(x)&&!isNaN(y)){x+=10;y-=30;x=Math.max(0,Math.min(maxX,x));y=Math.max(0,Math.min(maxY,y));if(mouseY<limitY){y=limitY;}
$elem.css({left:x,top:y});}},bind:function(elem,value){if(Galleria.TOUCH){return;}
if(!tooltip.initialized){tooltip.init();}
var hover=function(elem,value){tooltip.define(elem,value);$(elem).hover(function(){Utils.clearTimer(tooltip.swapTimer);self.$('container').unbind('mousemove',tooltip.move).bind('mousemove',tooltip.move).trigger('mousemove');tooltip.show(elem);Utils.addTimer(tooltip.timer,function(){self.$('tooltip').stop().show().animate({opacity:1});tooltip.open=true;},tooltip.open?0:500);},function(){self.$('container').unbind('mousemove',tooltip.move);Utils.clearTimer(tooltip.timer);self.$('tooltip').stop().animate({opacity:0},200,function(){self.$('tooltip').hide();Utils.addTimer(tooltip.swapTimer,function(){tooltip.open=false;},1000);});}).click(function(){$(this).trigger('mouseout');});};if(typeof value==='string'){hover((elem in self._dom?self.get(elem):elem),value);}else{$.each(elem,function(elemID,val){hover(self.get(elemID),val);});}},show:function(elem){elem=$(elem in self._dom?self.get(elem):elem);var text=elem.data('tt'),mouseup=function(e){window.setTimeout((function(ev){return function(){tooltip.move(ev);};}(e)),10);elem.unbind('mouseup',mouseup);};text=typeof text==='function'?text():text;if(!text){return;}
self.$('tooltip').html(text.replace(/\s/,'&nbsp;'));elem.bind('mouseup',mouseup);},define:function(elem,value){if(typeof value!=='function'){var s=value;value=function(){return s;};}
elem=$(elem in self._dom?self.get(elem):elem).data('tt',value);tooltip.show(elem);}};var fullscreen=this._fullscreen={scrolled:0,crop:undef,transition:undef,active:false,keymap:self._keyboard.map,os:{callback:F,support:(function(){var html=DOM().html;return html.requestFullscreen||html.mozRequestFullScreen||html.webkitRequestFullScreen;}()),enter:function(callback){fullscreen.os.callback=callback||F;var html=DOM().html;if(html.requestFullscreen){html.requestFullscreen();}
else if(html.mozRequestFullScreen){html.mozRequestFullScreen();}
else if(html.webkitRequestFullScreen){html.webkitRequestFullScreen();}},exit:function(callback){fullscreen.os.callback=callback||F;if(doc.exitFullscreen){doc.exitFullscreen();}
else if(doc.mozCancelFullScreen){doc.mozCancelFullScreen();}
else if(doc.webkitCancelFullScreen){doc.webkitCancelFullScreen();}},listen:function(){if(!fullscreen.os.support){return;}
var handler=function(){if(doc.fullscreen||doc.mozFullScreen||doc.webkitIsFullScreen){fullscreen._enter(fullscreen.os.callback);}else{fullscreen._exit(fullscreen.os.callback);}};doc.addEventListener('fullscreenchange',handler,false);doc.addEventListener('mozfullscreenchange',handler,false);doc.addEventListener('webkitfullscreenchange',handler,false);}},enter:function(callback){if(self._options.trueFullscreen&&fullscreen.os.support){fullscreen.os.enter(callback);}else{fullscreen._enter(callback);}},_enter:function(callback){fullscreen.active=true;Utils.hide(self.getActiveImage());self.$('container').addClass('fullscreen');fullscreen.scrolled=$win.scrollTop();Utils.forceStyles(self.get('container'),{position:'fixed',top:0,left:0,width:'100%',height:'100%',zIndex:10000});var htmlbody={height:'100%',overflow:'hidden',margin:0,padding:0},data=self.getData(),options=self._options;Utils.forceStyles(DOM().html,htmlbody);Utils.forceStyles(DOM().body,htmlbody);fullscreen.keymap=$.extend({},self._keyboard.map);self.attachKeyboard({escape:self.exitFullscreen,right:self.next,left:self.prev});fullscreen.crop=options.imageCrop;if(options.fullscreenCrop!=undef){options.imageCrop=options.fullscreenCrop;}
if(data&&data.big&&data.image!==data.big){var big=new Galleria.Picture(),cached=big.isCached(data.big),index=self.getIndex(),thumb=self._thumbnails[index];self.trigger({type:Galleria.LOADSTART,cached:cached,rewind:false,index:index,imageTarget:self.getActiveImage(),thumbTarget:thumb,galleriaData:data});big.load(data.big,function(big){self._scaleImage(big,{complete:function(big){self.trigger({type:Galleria.LOADFINISH,cached:cached,index:index,rewind:false,imageTarget:big.image,thumbTarget:thumb});var image=self._controls.getActive().image;if(image){$(image).width(big.image.width).height(big.image.height).attr('style',$(big.image).attr('style')).attr('src',big.image.src);}}});});}
self.rescale(function(){Utils.addTimer(false,function(){Utils.show(self.getActiveImage());if(typeof callback==='function'){callback.call(self);}},100);self.trigger(Galleria.FULLSCREEN_ENTER);});$win.resize(function(){fullscreen.scale();});},scale:function(){self.rescale();},exit:function(callback){if(self._options.trueFullscreen&&fullscreen.os.support){fullscreen.os.exit(callback);}else{fullscreen._exit(callback);}},_exit:function(callback){fullscreen.active=false;Utils.hide(self.getActiveImage());self.$('container').removeClass('fullscreen');Utils.revertStyles(self.get('container'),DOM().html,DOM().body);window.scrollTo(0,fullscreen.scrolled);self.detachKeyboard();self.attachKeyboard(fullscreen.keymap);self._options.imageCrop=fullscreen.crop;var big=self.getData().big,image=self._controls.getActive().image;if(!self.getData().iframe&&image&&big&&big==image.src){window.setTimeout(function(src){return function(){image.src=src;};}(self.getData().image),1);}
self.rescale(function(){Utils.addTimer(false,function(){Utils.show(self.getActiveImage());if(typeof callback==='function'){callback.call(self);}
$win.trigger('resize');},50);self.trigger(Galleria.FULLSCREEN_EXIT);});$win.unbind('resize',fullscreen.scale);}};fullscreen.os.listen();var idle=this._idle={timer:'idle'+self._id,trunk:[],bound:false,add:function(elem,to){if(!elem){return;}
if(!idle.bound){idle.addEvent();}
elem=$(elem);var from={},style;for(style in to){if(to.hasOwnProperty(style)){from[style]=elem.css(style);}}
elem.data('idle',{from:from,to:to,complete:true,busy:false});idle.addTimer();idle.trunk.push(elem);},remove:function(elem){elem=jQuery(elem);$.each(idle.trunk,function(i,el){if(el&&el.length&&!el.not(elem).length){self._idle.show(elem);self._idle.trunk.splice(i,1);}});if(!idle.trunk.length){idle.removeEvent();Utils.clearTimer(idle.timer);}},addEvent:function(){idle.bound=true;self.$('container').bind('mousemove click',idle.showAll);},removeEvent:function(){idle.bound=false;self.$('container').unbind('mousemove click',idle.showAll);},addTimer:function(){Utils.addTimer(idle.timer,function(){idle.hide();},self._options.idleTime);},hide:function(){if(!self._options.idleMode||self.getIndex()===false||self.getData().iframe){return;}
self.trigger(Galleria.IDLE_ENTER);$.each(idle.trunk,function(i,elem){var data=elem.data('idle');if(!data){return;}
elem.data('idle').complete=false;Utils.animate(elem,data.to,{duration:self._options.idleSpeed});});},showAll:function(){Utils.clearTimer(idle.timer);$.each(idle.trunk,function(i,elem){idle.show(elem);});},show:function(elem){var data=elem.data('idle');if(!data.busy&&!data.complete){data.busy=true;self.trigger(Galleria.IDLE_EXIT);Utils.clearTimer(idle.timer);Utils.animate(elem,data.from,{duration:self._options.idleSpeed/2,complete:function(){$(this).data('idle').busy=false;$(this).data('idle').complete=true;}});}
idle.addTimer();}};var lightbox=this._lightbox={width:0,height:0,initialized:false,active:null,image:null,elems:{},keymap:false,init:function(){self.trigger(Galleria.LIGHTBOX_OPEN);if(lightbox.initialized){return;}
lightbox.initialized=true;var elems='overlay box content shadow title info close prevholder prev nextholder next counter image',el={},op=self._options,css='',abs='position:absolute;',prefix='lightbox-',cssMap={overlay:'position:fixed;display:none;opacity:'+op.overlayOpacity+';filter:alpha(opacity='+(op.overlayOpacity*100)+');top:0;left:0;width:100%;height:100%;background:'+op.overlayBackground+';z-index:99990',box:'position:fixed;display:none;width:400px;height:400px;top:50%;left:50%;margin-top:-200px;margin-left:-200px;z-index:99991',shadow:abs+'background:#000;width:100%;height:100%;',content:abs+'background-color:#fff;top:10px;left:10px;right:10px;bottom:10px;overflow:hidden',info:abs+'bottom:10px;left:10px;right:10px;color:#444;font:11px/13px arial,sans-serif;height:13px',close:abs+'top:10px;right:10px;height:20px;width:20px;background:#fff;text-align:center;cursor:pointer;color:#444;font:16px/22px arial,sans-serif;z-index:99999',image:abs+'top:10px;left:10px;right:10px;bottom:30px;overflow:hidden;display:block;',prevholder:abs+'width:50%;top:0;bottom:40px;cursor:pointer;',nextholder:abs+'width:50%;top:0;bottom:40px;right:-1px;cursor:pointer;',prev:abs+'top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;left:20px;display:none;text-align:center;color:#000;font:bold 16px/36px arial,sans-serif',next:abs+'top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;right:20px;left:auto;display:none;font:bold 16px/36px arial,sans-serif;text-align:center;color:#000',title:'float:left',counter:'float:right;margin-left:8px;'},hover=function(elem){return elem.hover(function(){$(this).css('color','#bbb');},function(){$(this).css('color','#444');});},appends={};if(IE&&IE>7){cssMap.nextholder+='background:#000;filter:alpha(opacity=0);';cssMap.prevholder+='background:#000;filter:alpha(opacity=0);';}
$.each(cssMap,function(key,value){css+='.galleria-'+prefix+key+'{'+value+'}';});css+='.galleria-'+prefix+'box.iframe .galleria-'+prefix+'prevholder,'+'.galleria-'+prefix+'box.iframe .galleria-'+prefix+'nextholder{'+'width:100px;height:100px;top:50%;margin-top:-70px}';Utils.insertStyleTag(css);$.each(elems.split(' '),function(i,elemId){self.addElement('lightbox-'+elemId);el[elemId]=lightbox.elems[elemId]=self.get('lightbox-'+elemId);});lightbox.image=new Galleria.Picture();$.each({box:'shadow content close prevholder nextholder',info:'title counter',content:'info image',prevholder:'prev',nextholder:'next'},function(key,val){var arr=[];$.each(val.split(' '),function(i,prop){arr.push(prefix+prop);});appends[prefix+key]=arr;});self.append(appends);$(el.image).append(lightbox.image.container);$(DOM().body).append(el.overlay,el.box);Utils.optimizeTouch(el.box);hover($(el.close).bind('click',lightbox.hide).html('&#215;'));$.each(['Prev','Next'],function(i,dir){var $d=$(el[dir.toLowerCase()]).html(/v/.test(dir)?'&#8249;&nbsp;':'&nbsp;&#8250;'),$e=$(el[dir.toLowerCase()+'holder']);$e.bind('click',function(){lightbox['show'+dir]();});if(IE<8||Galleria.TOUCH){$d.show();return;}
$e.hover(function(){$d.show();},function(e){$d.stop().fadeOut(200);});});$(el.overlay).bind('click',lightbox.hide);if(Galleria.IPAD){self._options.lightboxTransitionSpeed=0;}},rescale:function(event){var width=Math.min($win.width()-40,lightbox.width),height=Math.min($win.height()-60,lightbox.height),ratio=Math.min(width/lightbox.width,height/lightbox.height),destWidth=Math.round(lightbox.width*ratio)+40,destHeight=Math.round(lightbox.height*ratio)+60,to={width:destWidth,height:destHeight,'margin-top':Math.ceil(destHeight/2)*-1,'margin-left':Math.ceil(destWidth/2)*-1};if(event){$(lightbox.elems.box).css(to);}else{$(lightbox.elems.box).animate(to,{duration:self._options.lightboxTransitionSpeed,easing:self._options.easing,complete:function(){var image=lightbox.image,speed=self._options.lightboxFadeSpeed;self.trigger({type:Galleria.LIGHTBOX_IMAGE,imageTarget:image.image});$(image.container).show();$(image.image).animate({opacity:1},speed);Utils.show(lightbox.elems.info,speed);}});}},hide:function(){lightbox.image.image=null;$win.unbind('resize',lightbox.rescale);$(lightbox.elems.box).hide();Utils.hide(lightbox.elems.info);self.detachKeyboard();self.attachKeyboard(lightbox.keymap);lightbox.keymap=false;Utils.hide(lightbox.elems.overlay,200,function(){$(this).hide().css('opacity',self._options.overlayOpacity);self.trigger(Galleria.LIGHTBOX_CLOSE);});},showNext:function(){lightbox.show(self.getNext(lightbox.active));},showPrev:function(){lightbox.show(self.getPrev(lightbox.active));},show:function(index){lightbox.active=index=typeof index==='number'?index:self.getIndex()||0;if(!lightbox.initialized){lightbox.init();}
if(!lightbox.keymap){lightbox.keymap=$.extend({},self._keyboard.map);self.attachKeyboard({escape:lightbox.hide,right:lightbox.showNext,left:lightbox.showPrev});}
$win.unbind('resize',lightbox.rescale);var data=self.getData(index),total=self.getDataLength(),n=self.getNext(index),ndata,p,i;Utils.hide(lightbox.elems.info);try{for(i=self._options.preload;i>0;i--){p=new Galleria.Picture();ndata=self.getData(n);p.preload('big'in ndata?ndata.big:ndata.image);n=self.getNext(n);}}catch(e){}
lightbox.image.isIframe=!!data.iframe;$(lightbox.elems.box).toggleClass('iframe',!!data.iframe);lightbox.image.load(data.iframe||data.big||data.image,function(image){lightbox.width=image.isIframe?$(window).width():image.original.width;lightbox.height=image.isIframe?$(window).height():image.original.height;$(image.image).css({width:image.isIframe?'100%':'100.1%',height:image.isIframe?'100%':'100.1%',top:0,zIndex:99998,opacity:0,visibility:'visible'});lightbox.elems.title.innerHTML=data.title||'';lightbox.elems.counter.innerHTML=(index+1)+' / '+total;$win.resize(lightbox.rescale);lightbox.rescale();});$(lightbox.elems.overlay).show().css('visibility','visible');$(lightbox.elems.box).show();}};return this;};Galleria.prototype={constructor:Galleria,init:function(target,options){var self=this;options=_legacyOptions(options);this._original={target:target,options:options,data:null};this._target=this._dom.target=target.nodeName?target:$(target).get(0);this._original.html=this._target.innerHTML;_instances.push(this);if(!this._target){Galleria.raise('Target not found',true);return;}
this._options={autoplay:false,carousel:true,carouselFollow:true,carouselSpeed:400,carouselSteps:'auto',clicknext:false,dailymotion:{foreground:'%23EEEEEE',highlight:'%235BCEC5',background:'%23222222',logo:0,hideInfos:1},dataConfig:function(elem){return{};},dataSelector:'img',dataSource:this._target,debug:undef,dummy:undef,easing:'galleria',extend:function(options){},fullscreenCrop:undef,fullscreenDoubleTap:true,fullscreenTransition:undef,height:0,idleMode:true,idleTime:3000,idleSpeed:200,imageCrop:false,imageMargin:0,imagePan:false,imagePanSmoothness:12,imagePosition:'50%',imageTimeout:undef,initialTransition:undef,keepSource:false,layerFollow:true,lightbox:false,lightboxFadeSpeed:200,lightboxTransitionSpeed:200,linkSourceImages:true,maxScaleRatio:undef,minScaleRatio:undef,overlayOpacity:0.85,overlayBackground:'#0b0b0b',pauseOnInteraction:true,popupLinks:false,preload:2,queue:true,responsive:false,show:0,showInfo:true,showCounter:true,showImagenav:true,swipe:true,thumbCrop:true,thumbEventType:'click',thumbFit:true,thumbMargin:0,thumbQuality:'auto',thumbnails:true,touchTransition:undef,transition:'fade',transitionInitial:undef,transitionSpeed:400,trueFullscreen:true,useCanvas:false,vimeo:{title:0,byline:0,portrait:0,color:'aaaaaa'},wait:5000,width:'auto',youtube:{modestbranding:1,autohide:1,color:'white',hd:1,rel:0,showinfo:0}};this._options.initialTransition=this._options.initialTransition||this._options.transitionInitial;if(options&&options.debug===false){DEBUG=false;}
if(options&&typeof options.imageTimeout==='number'){TIMEOUT=options.imageTimeout;}
if(options&&typeof options.dummy==='string'){DUMMY=options.dummy;}
$(this._target).children().hide();if(typeof Galleria.theme==='object'){this._init();}else{_pool.push(this);}
return this;},_init:function(){var self=this,options=this._options;if(this._initialized){Galleria.raise('Init failed: Gallery instance already initialized.');return this;}
this._initialized=true;if(!Galleria.theme){Galleria.raise('Init failed: No theme found.',true);return this;}
$.extend(true,options,Galleria.theme.defaults,this._original.options,Galleria.configure.options);(function(can){if(!('getContext'in can)){can=null;return;}
_canvas=_canvas||{elem:can,context:can.getContext('2d'),cache:{},length:0};}(doc.createElement('canvas')));this.bind(Galleria.DATA,function(){if(Galleria.QUIRK){Galleria.raise('Your page is in Quirks mode, Galleria may not render correctly. Please validate your HTML.');}
this._original.data=this._data;this.get('total').innerHTML=this.getDataLength();var $container=this.$('container');var num={width:0,height:0};var testHeight=function(){return self.$('stage').height();};Utils.wait({until:function(){num=self._getWH();$container.width(num.width).height(num.height);return testHeight()&&num.width&&num.height>50;},success:function(){self._width=num.width;self._height=num.height;if(Galleria.WEBKIT){window.setTimeout(function(){self._run();},1);}else{self._run();}},error:function(){if(testHeight()){Galleria.raise('Could not extract sufficient width/height of the gallery container. Traced measures: width:'+num.width+'px, height: '+num.height+'px.',true);}else{Galleria.raise('Could not extract a stage height from the CSS. Traced height: '+testHeight()+'px.',true);}},timeout:typeof this._options.wait=='number'?this._options.wait:false});});this.append({'info-text':['info-title','info-description'],'info':['info-text'],'image-nav':['image-nav-right','image-nav-left'],'stage':['images','loader','counter','image-nav'],'thumbnails-list':['thumbnails'],'thumbnails-container':['thumb-nav-left','thumbnails-list','thumb-nav-right'],'container':['stage','thumbnails-container','info','tooltip']});Utils.hide(this.$('counter').append(this.get('current'),doc.createTextNode(' / '),this.get('total')));this.setCounter('&#8211;');Utils.hide(self.get('tooltip'));this.$('container').addClass(Galleria.TOUCH?'touch':'notouch');$.each(new Array(2),function(i){var image=new Galleria.Picture();$(image.container).css({position:'absolute',top:0,left:0}).prepend(self._layers[i]=$(Utils.create('galleria-layer')).css({position:'absolute',top:0,left:0,right:0,bottom:0,zIndex:2})[0]);self.$('images').append(image.container);self._controls[i]=image;});this.$('images').css({position:'relative',top:0,left:0,width:'100%',height:'100%'});this.$('thumbnails, thumbnails-list').css({overflow:'hidden',position:'relative'});this.$('image-nav-right, image-nav-left').bind('click',function(e){if(options.clicknext){e.stopPropagation();}
if(options.pauseOnInteraction){self.pause();}
var fn=/right/.test(this.className)?'next':'prev';self[fn]();});$.each(['info','counter','image-nav'],function(i,el){if(options['show'+el.substr(0,1).toUpperCase()+el.substr(1).replace(/-/,'')]===false){Utils.moveOut(self.get(el.toLowerCase()));}});this.load();if(!options.keepSource&&!IE){this._target.innerHTML='';}
if(this.get('errors')){this.appendChild('target','errors');}
this.appendChild('target','container');if(options.carousel){var count=0,show=options.show;this.bind(Galleria.THUMBNAIL,function(){this.updateCarousel();if(++count==this.getDataLength()&&typeof show=='number'&&show>0){this._carousel.follow(show);}});}
if(options.responsive){$win.bind('resize',function(){if(!self.isFullscreen()){self.resize();}});}
if(options.swipe){(function(images){var swipeStart=[0,0],swipeStop=[0,0],limitX=30,limitY=100,multi=false,tid=0,data,ev={start:'touchstart',move:'touchmove',stop:'touchend'},getData=function(e){return e.originalEvent.touches?e.originalEvent.touches[0]:e;},moveHandler=function(e){if(e.originalEvent.touches&&e.originalEvent.touches.length>1){return;}
data=getData(e);swipeStop=[data.pageX,data.pageY];if(!swipeStart[0]){swipeStart=swipeStop;}
if(Math.abs(swipeStart[0]-swipeStop[0])>10){e.preventDefault();}},upHandler=function(e){images.unbind(ev.move,moveHandler);if((e.originalEvent.touches&&e.originalEvent.touches.length)||multi){multi=!multi;return;}
if(Utils.timestamp()-tid<1000&&Math.abs(swipeStart[0]-swipeStop[0])>limitX&&Math.abs(swipeStart[1]-swipeStop[1])<limitY){e.preventDefault();self[swipeStart[0]>swipeStop[0]?'next':'prev']();}
swipeStart=swipeStop=[0,0];};images.bind(ev.start,function(e){if(e.originalEvent.touches&&e.originalEvent.touches.length>1){return;}
data=getData(e);tid=Utils.timestamp();swipeStart=swipeStop=[data.pageX,data.pageY];images.bind(ev.move,moveHandler).one(ev.stop,upHandler);});}(self.$('images')));if(options.fullscreenDoubleTap){this.$('stage').bind('touchstart',(function(){var last,cx,cy,lx,ly,now,getData=function(e){return e.originalEvent.touches?e.originalEvent.touches[0]:e;};return function(e){now=Galleria.utils.timestamp();cx=getData(e).pageX;cy=getData(e).pageY;if((now-last<500)&&(cx-lx<20)&&(cy-ly<20)){self.toggleFullscreen();e.preventDefault();self.$('stage').unbind('touchend',arguments.callee);return;}
last=now;lx=cx;ly=cy;};}()));}}
Utils.optimizeTouch(this.get('container'));$.each(Galleria.on.binds,function(i,bind){self.bind(bind.type,bind.callback);});return this;},_getWH:function(){var $container=this.$('container'),$target=this.$('target'),self=this,num={},arr;$.each(['width','height'],function(i,m){if(self._options[m]&&typeof self._options[m]==='number'){num[m]=self._options[m];}else{arr=[Utils.parseValue($container.css(m)),Utils.parseValue($target.css(m)),$container[m](),$target[m]()];if(!self['_'+m]){arr.splice(arr.length,Utils.parseValue($container.css('min-'+m)),Utils.parseValue($target.css('min-'+m)));}
num[m]=Math.max.apply(Math,arr);}});if(self._options.height&&self._options.height<2){num.height=num.width*self._options.height;}
return num;},_createThumbnails:function(){this.get('total').innerHTML=this.getDataLength();var i,src,thumb,data,special,$container,self=this,o=this._options,active=(function(){var a=self.$('thumbnails').find('.active');if(!a.length){return false;}
return a.find('img').attr('src');}()),optval=typeof o.thumbnails==='string'?o.thumbnails.toLowerCase():null,getStyle=function(prop){return doc.defaultView&&doc.defaultView.getComputedStyle?doc.defaultView.getComputedStyle(thumb.container,null)[prop]:$container.css(prop);},fake=function(image,index,container){return function(){$(container).append(image);self.trigger({type:Galleria.THUMBNAIL,thumbTarget:image,index:index,galleriaData:self.getData(index)});};},onThumbEvent=function(e){if(o.pauseOnInteraction){self.pause();}
var index=$(e.currentTarget).data('index');if(self.getIndex()!==index){self.show(index);}
e.preventDefault();},onThumbLoad=function(thumb){thumb.scale({width:thumb.data.width,height:thumb.data.height,crop:o.thumbCrop,margin:o.thumbMargin,canvas:o.useCanvas,complete:function(thumb){var top=['left','top'],arr=['Width','Height'],m,css,data=self.getData(thumb.index),special=data.thumb.split(':');$.each(arr,function(i,measure){m=measure.toLowerCase();if((o.thumbCrop!==true||o.thumbCrop===m)&&o.thumbFit){css={};css[m]=thumb[m];$(thumb.container).css(css);css={};css[top[i]]=0;$(thumb.image).css(css);}
thumb['outer'+measure]=$(thumb.container)['outer'+measure](true);});Utils.toggleQuality(thumb.image,o.thumbQuality===true||(o.thumbQuality==='auto'&&thumb.original.width<thumb.width*3));if(data.iframe&&special.length==2&&special[0]in _video){_video[special[0]].getThumb(special[1],(function(img){return function(src){img.src=src;};}(thumb.image)));}
self.trigger({type:Galleria.THUMBNAIL,thumbTarget:thumb.image,index:thumb.data.order,galleriaData:self.getData(thumb.data.order)});}});};this._thumbnails=[];this.$('thumbnails').empty();for(i=0;this._data[i];i++){data=this._data[i];if(o.thumbnails===true&&(data.thumb||data.image)){thumb=new Galleria.Picture(i);thumb.index=i;src=data.thumb||data.image;this.$('thumbnails').append(thumb.container);$container=$(thumb.container);thumb.data={width:Utils.parseValue(getStyle('width')),height:Utils.parseValue(getStyle('height')),order:i};if(o.thumbFit&&o.thumbCrop!==true){$container.css({width:'auto',height:'auto'});}else{$container.css({width:thumb.data.width,height:thumb.data.height});}
special=src.split(':');if(special.length==2&&special[0]in _video){thumb.load('data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw%3D%3D',{height:thumb.data.height,width:thumb.data.height*1.25},onThumbLoad);}else{thumb.load(src,onThumbLoad);}
if(o.preload==='all'){thumb.preload(data.image);}}else if(data.iframe||optval==='empty'||optval==='numbers'){thumb={container:Utils.create('galleria-image'),image:Utils.create('img','span'),ready:true};if(optval==='numbers'){$(thumb.image).text(i+1);}
if(data.iframe){$(thumb.image).addClass('iframe');}
this.$('thumbnails').append(thumb.container);window.setTimeout((fake)(thumb.image,i,thumb.container),50+(i*20));}else{thumb={container:null,image:null};}
$(thumb.container).add(o.keepSource&&o.linkSourceImages?data.original:null).data('index',i).bind(o.thumbEventType,onThumbEvent);if(active===src){$(thumb.container).addClass('active');}
this._thumbnails.push(thumb);}},_run:function(){var self=this;self._createThumbnails();Utils.wait({timeout:10000,until:function(){if(Galleria.OPERA){self.$('stage').css('display','inline-block');}
self._stageWidth=self.$('stage').width();self._stageHeight=self.$('stage').height();return(self._stageWidth&&self._stageHeight>50);},success:function(){_galleries.push(self);Utils.show(self.get('counter'));if(self._options.carousel){self._carousel.bindControls();}
if(self._options.autoplay){self.pause();if(typeof self._options.autoplay==='number'){self._playtime=self._options.autoplay;}
self.trigger(Galleria.PLAY);self._playing=true;}
if(self._firstrun){if(typeof self._options.show==='number'){self.show(self._options.show);}
return;}
self._firstrun=true;if(Galleria.History){Galleria.History.change(function(value){if(isNaN(value)){window.history.go(-1);}else{self.show(value,undef,true);}});}
self.trigger(Galleria.READY);Galleria.theme.init.call(self,self._options);$.each(Galleria.ready.callbacks,function(){this.call(self,self._options);});self._options.extend.call(self,self._options);if(/^[0-9]{1,4}$/.test(HASH)&&Galleria.History){self.show(HASH,undef,true);}else if(self._data[self._options.show]){self.show(self._options.show);}},error:function(){Galleria.raise('Stage width or height is too small to show the gallery. Traced measures: width:'+self._stageWidth+'px, height: '+self._stageHeight+'px.',true);}});},load:function(source,selector,config){var self=this;this._data=[];this._thumbnails=[];this.$('thumbnails').empty();if(typeof selector==='function'){config=selector;selector=null;}
source=source||this._options.dataSource;selector=selector||this._options.dataSelector;config=config||this._options.dataConfig;if(/^function Object/.test(source.constructor)){source=[source];}
if(source.constructor===Array){if(this.validate(source)){this._data=source;this._parseData().trigger(Galleria.DATA);}else{Galleria.raise('Load failed: JSON Array not valid.');}
return this;}
selector+=',.video,.iframe';$(source).find(selector).each(function(i,elem){elem=$(elem);var data={},parent=elem.parent(),href=parent.attr('href'),rel=parent.attr('rel');if(href&&(elem[0].nodeName=='IMG'||elem.hasClass('video'))&&_videoTest(href)){data.video=href;}else if(href&&elem.hasClass('iframe')){data.iframe=href;}else{data.image=data.big=href;}
if(rel){data.big=rel;}
$.each('big title description link layer'.split(' '),function(i,val){if(elem.data(val)){data[val]=elem.data(val);}});self._data.push($.extend({title:elem.attr('title')||'',thumb:elem.attr('src'),image:elem.attr('src'),big:elem.attr('src'),description:elem.attr('alt')||'',link:elem.attr('longdesc'),original:elem.get(0)},data,config(elem)));});if(this.getDataLength()){this._parseData().trigger(Galleria.DATA);}else{Galleria.raise('Load failed: no data found.');}
return this;},_parseData:function(){var self=this,current;$.each(this._data,function(i,data){current=self._data[i];if('thumb'in data===false){current.thumb=data.image;}
if(!'big'in data){current.big=data.image;}
if('video'in data){var result=_videoTest(data.video);if(result){current.iframe=_video[result.provider].embed(result.id)+(function(){if(typeof self._options[result.provider]=='object'){var str='?',arr=[];$.each(self._options[result.provider],function(key,val){arr.push(key+'='+val);});if(result.provider=='youtube'){arr=['wmode=opaque'].concat(arr);}
return str+arr.join('&');}
return'';}());delete current.video;if(!('thumb'in current)||!current.thumb){current.thumb=result.provider+':'+result.id;}}}});return this;},destroy:function(){this.get('target').innerHTML=this._original.html;return this;},splice:function(){var self=this,args=Utils.array(arguments);window.setTimeout(function(){protoArray.splice.apply(self._data,args);self._parseData()._createThumbnails();},2);return self;},push:function(){var self=this,args=Utils.array(arguments);window.setTimeout(function(){protoArray.push.apply(self._data,args);self._parseData()._createThumbnails();},2);return self;},_getActive:function(){return this._controls.getActive();},validate:function(data){return true;},bind:function(type,fn){type=_patchEvent(type);this.$('container').bind(type,this.proxy(fn));return this;},unbind:function(type){type=_patchEvent(type);this.$('container').unbind(type);return this;},trigger:function(type){type=typeof type==='object'?$.extend(type,{scope:this}):{type:_patchEvent(type),scope:this};this.$('container').trigger(type);return this;},addIdleState:function(elem,styles){this._idle.add.apply(this._idle,Utils.array(arguments));return this;},removeIdleState:function(elem){this._idle.remove.apply(this._idle,Utils.array(arguments));return this;},enterIdleMode:function(){this._idle.hide();return this;},exitIdleMode:function(){this._idle.showAll();return this;},enterFullscreen:function(callback){this._fullscreen.enter.apply(this,Utils.array(arguments));return this;},exitFullscreen:function(callback){this._fullscreen.exit.apply(this,Utils.array(arguments));return this;},toggleFullscreen:function(callback){this._fullscreen[this.isFullscreen()?'exit':'enter'].apply(this,Utils.array(arguments));return this;},bindTooltip:function(elem,value){this._tooltip.bind.apply(this._tooltip,Utils.array(arguments));return this;},defineTooltip:function(elem,value){this._tooltip.define.apply(this._tooltip,Utils.array(arguments));return this;},refreshTooltip:function(elem){this._tooltip.show.apply(this._tooltip,Utils.array(arguments));return this;},openLightbox:function(){this._lightbox.show.apply(this._lightbox,Utils.array(arguments));return this;},closeLightbox:function(){this._lightbox.hide.apply(this._lightbox,Utils.array(arguments));return this;},getActiveImage:function(){return this._getActive().image||undef;},getActiveThumb:function(){return this._thumbnails[this._active].image||undef;},getMousePosition:function(e){return{x:e.pageX-this.$('container').offset().left,y:e.pageY-this.$('container').offset().top};},addPan:function(img){if(this._options.imageCrop===false){return;}
img=$(img||this.getActiveImage());var self=this,x=img.width()/2,y=img.height()/2,destX=parseInt(img.css('left'),10),destY=parseInt(img.css('top'),10),curX=destX||0,curY=destY||0,distX=0,distY=0,active=false,ts=Utils.timestamp(),cache=0,move=0,position=function(dist,cur,pos){if(dist>0){move=Math.round(Math.max(dist*-1,Math.min(0,cur)));if(cache!==move){cache=move;if(IE===8){img.parent()['scroll'+pos](move*-1);}else{var css={};css[pos.toLowerCase()]=move;img.css(css);}}}},calculate=function(e){if(Utils.timestamp()-ts<50){return;}
active=true;x=self.getMousePosition(e).x;y=self.getMousePosition(e).y;},loop=function(e){if(!active){return;}
distX=img.width()-self._stageWidth;distY=img.height()-self._stageHeight;destX=x/self._stageWidth*distX*-1;destY=y/self._stageHeight*distY*-1;curX+=(destX-curX)/self._options.imagePanSmoothness;curY+=(destY-curY)/self._options.imagePanSmoothness;position(distY,curY,'Top');position(distX,curX,'Left');};if(IE===8){img.parent().scrollTop(curY*-1).scrollLeft(curX*-1);img.css({top:0,left:0});}
this.$('stage').unbind('mousemove',calculate).bind('mousemove',calculate);Utils.addTimer('pan'+self._id,loop,50,true);return this;},proxy:function(fn,scope){if(typeof fn!=='function'){return F;}
scope=scope||this;return function(){return fn.apply(scope,Utils.array(arguments));};},removePan:function(){this.$('stage').unbind('mousemove');Utils.clearTimer('pan'+this._id);return this;},addElement:function(id){var dom=this._dom;$.each(Utils.array(arguments),function(i,blueprint){dom[blueprint]=Utils.create('galleria-'+blueprint);});return this;},attachKeyboard:function(map){this._keyboard.attach.apply(this._keyboard,Utils.array(arguments));return this;},detachKeyboard:function(){this._keyboard.detach.apply(this._keyboard,Utils.array(arguments));return this;},appendChild:function(parentID,childID){this.$(parentID).append(this.get(childID)||childID);return this;},prependChild:function(parentID,childID){this.$(parentID).prepend(this.get(childID)||childID);return this;},remove:function(elemID){this.$(Utils.array(arguments).join(',')).remove();return this;},append:function(data){var i,j;for(i in data){if(data.hasOwnProperty(i)){if(data[i].constructor===Array){for(j=0;data[i][j];j++){this.appendChild(i,data[i][j]);}}else{this.appendChild(i,data[i]);}}}
return this;},_scaleImage:function(image,options){image=image||this._controls.getActive();if(!image){return;}
var self=this,complete,scaleLayer=function(img){$(img.container).children(':first').css({top:Math.max(0,Utils.parseValue(img.image.style.top)),left:Math.max(0,Utils.parseValue(img.image.style.left)),width:Utils.parseValue(img.image.width),height:Utils.parseValue(img.image.height)});};options=$.extend({width:this._stageWidth,height:this._stageHeight,crop:this._options.imageCrop,max:this._options.maxScaleRatio,min:this._options.minScaleRatio,margin:this._options.imageMargin,position:this._options.imagePosition},options);if(this._options.layerFollow&&this._options.imageCrop!==true){if(typeof options.complete=='function'){complete=options.complete;options.complete=function(){complete.call(image,image);scaleLayer(image);};}else{options.complete=scaleLayer;}}else{$(image.container).children(':first').css({top:0,left:0});}
image.scale(options);return this;},updateCarousel:function(){this._carousel.update();return this;},resize:function(measures,complete){if(typeof measures=='function'){complete=measures;measures=undef;}
measures=$.extend({width:0,height:0},measures);var self=this,$container=this.$('container'),aspect=this._options.responsive=='aspect'&&(!measures.width||!measures.height),ratio;$.each(measures,function(m,val){if(!val){$container[m]('auto');measures[m]=self._getWH()[m];}});if(aspect){ratio=Math.min(measures.width/this._width,measures.height/this._height);}
$.each(measures,function(m,val){$container[m](ratio?ratio*self['_'+m]:val);});return this.rescale(complete);},rescale:function(width,height,complete){var self=this;if(typeof width==='function'){complete=width;width=undef;}
var scale=function(){self._stageWidth=width||self.$('stage').width();self._stageHeight=height||self.$('stage').height();self._scaleImage();if(self._options.carousel){self.updateCarousel();}
self.trigger(Galleria.RESCALE);if(typeof complete==='function'){complete.call(self);}};if(Galleria.WEBKIT&&!Galleria.TOUCH&&!width&&!height){Utils.addTimer(false,scale,10);}else{scale.call(self);}
return this;},refreshImage:function(){this._scaleImage();if(this._options.imagePan){this.addPan();}
return this;},show:function(index,rewind,_history){if(index===false||(!this._options.queue&&this._queue.stalled)){return;}
index=Math.max(0,Math.min(parseInt(index,10),this.getDataLength()-1));rewind=typeof rewind!=='undefined'?!!rewind:index<this.getIndex();_history=_history||false;if(!_history&&Galleria.History){Galleria.History.set(index.toString());return;}
this._active=index;protoArray.push.call(this._queue,{index:index,rewind:rewind});if(!this._queue.stalled){this._show();}
return this;},_show:function(){var self=this,queue=this._queue[0],data=this.getData(queue.index);if(!data){return;}
var src=data.iframe||(this.isFullscreen()&&'big'in data?data.big:data.image),active=this._controls.getActive(),next=this._controls.getNext(),cached=next.isCached(src),thumb=this._thumbnails[queue.index],mousetrigger=function(){$(next.image).trigger('mouseup');};var complete=(function(data,next,active,queue,thumb){return function(){var win;self._queue.stalled=false;Utils.toggleQuality(next.image,self._options.imageQuality);self._layers[self._controls.active].innerHTML='';$(active.container).css({zIndex:0,opacity:0}).show();if(active.isIframe){$(active.container).find('iframe').remove();}
self.$('container').toggleClass('iframe',!!data.iframe);$(next.container).css({zIndex:1,left:0,top:0}).show();self._controls.swap();if(self._options.imagePan){self.addPan(next.image);}
if(data.link||self._options.lightbox||self._options.clicknext){$(next.image).css({cursor:'pointer'}).bind('mouseup',function(){if(self._options.clicknext&&!Galleria.TOUCH){if(self._options.pauseOnInteraction){self.pause();}
self.next();return;}
if(data.link){if(self._options.popupLinks){win=window.open(data.link,'_blank');}else{window.location.href=data.link;}
return;}
if(self._options.lightbox){self.openLightbox();}});}
protoArray.shift.call(self._queue);if(self._queue.length){self._show();}
self._playCheck();self.trigger({type:Galleria.IMAGE,index:queue.index,imageTarget:next.image,thumbTarget:thumb.image,galleriaData:data});};}(data,next,active,queue,thumb));if(this._options.carousel&&this._options.carouselFollow){this._carousel.follow(queue.index);}
if(this._options.preload){var p,i,n=this.getNext(),ndata;try{for(i=this._options.preload;i>0;i--){p=new Galleria.Picture();ndata=self.getData(n);p.preload(this.isFullscreen()&&'big'in ndata?ndata.big:ndata.image);n=self.getNext(n);}}catch(e){}}
Utils.show(next.container);next.isIframe=!!data.iframe;$(self._thumbnails[queue.index].container).addClass('active').siblings('.active').removeClass('active');self.trigger({type:Galleria.LOADSTART,cached:cached,index:queue.index,rewind:queue.rewind,imageTarget:next.image,thumbTarget:thumb.image,galleriaData:data});next.load(src,function(next){var layer=$(self._layers[1-self._controls.active]).html(data.layer||'').hide();self._scaleImage(next,{complete:function(next){if('image'in active){Utils.toggleQuality(active.image,false);}
Utils.toggleQuality(next.image,false);self._queue.stalled=true;self.removePan();self.setInfo(queue.index);self.setCounter(queue.index);if(data.layer){layer.show();if(data.link||self._options.lightbox||self._options.clicknext){layer.css('cursor','pointer').unbind('mouseup').mouseup(mousetrigger);}}
self.trigger({type:Galleria.LOADFINISH,cached:cached,index:queue.index,rewind:queue.rewind,imageTarget:next.image,thumbTarget:self._thumbnails[queue.index].image,galleriaData:self.getData(queue.index)});var transition=self._options.transition;$.each({initial:active.image===null,touch:Galleria.TOUCH,fullscreen:self.isFullscreen()},function(type,arg){if(arg&&self._options[type+'Transition']!==undef){transition=self._options[type+'Transition'];return false;}});if(transition in _transitions===false){complete();}else{var params={prev:active.container,next:next.container,rewind:queue.rewind,speed:self._options.transitionSpeed||400};_transitions[transition].call(self,params,complete);}}});});},getNext:function(base){base=typeof base==='number'?base:this.getIndex();return base===this.getDataLength()-1?0:base+1;},getPrev:function(base){base=typeof base==='number'?base:this.getIndex();return base===0?this.getDataLength()-1:base-1;},next:function(){if(this.getDataLength()>1){this.show(this.getNext(),false);}
return this;},prev:function(){if(this.getDataLength()>1){this.show(this.getPrev(),true);}
return this;},get:function(elemId){return elemId in this._dom?this._dom[elemId]:null;},getData:function(index){return index in this._data?this._data[index]:this._data[this._active];},getDataLength:function(){return this._data.length;},getIndex:function(){return typeof this._active==='number'?this._active:false;},getStageHeight:function(){return this._stageHeight;},getStageWidth:function(){return this._stageWidth;},getOptions:function(key){return typeof key==='undefined'?this._options:this._options[key];},setOptions:function(key,value){if(typeof key==='object'){$.extend(this._options,key);}else{this._options[key]=value;}
return this;},play:function(delay){this._playing=true;this._playtime=delay||this._playtime;this._playCheck();this.trigger(Galleria.PLAY);return this;},pause:function(){this._playing=false;this.trigger(Galleria.PAUSE);return this;},playToggle:function(delay){return(this._playing)?this.pause():this.play(delay);},isPlaying:function(){return this._playing;},isFullscreen:function(){return this._fullscreen.active;},_playCheck:function(){var self=this,played=0,interval=20,now=Utils.timestamp(),timer_id='play'+this._id;if(this._playing){Utils.clearTimer(timer_id);var fn=function(){played=Utils.timestamp()-now;if(played>=self._playtime&&self._playing){Utils.clearTimer(timer_id);self.next();return;}
if(self._playing){self.trigger({type:Galleria.PROGRESS,percent:Math.ceil(played/self._playtime*100),seconds:Math.floor(played/1000),milliseconds:played});Utils.addTimer(timer_id,fn,interval);}};Utils.addTimer(timer_id,fn,interval);}},setPlaytime:function(delay){this._playtime=delay;return this;},setIndex:function(val){this._active=val;return this;},setCounter:function(index){if(typeof index==='number'){index++;}else if(typeof index==='undefined'){index=this.getIndex()+1;}
this.get('current').innerHTML=index;if(IE){var count=this.$('counter'),opacity=count.css('opacity');if(parseInt(opacity,10)===1){Utils.removeAlpha(count[0]);}else{this.$('counter').css('opacity',opacity);}}
return this;},setInfo:function(index){var self=this,data=this.getData(index);$.each(['title','description'],function(i,type){var elem=self.$('info-'+type);if(!!data[type]){elem[data[type].length?'show':'hide']().html(data[type]);}else{elem.empty().hide();}});return this;},hasInfo:function(index){var check='title description'.split(' '),i;for(i=0;check[i];i++){if(!!this.getData(index)[check[i]]){return true;}}
return false;},jQuery:function(str){var self=this,ret=[];$.each(str.split(','),function(i,elemId){elemId=$.trim(elemId);if(self.get(elemId)){ret.push(elemId);}});var jQ=$(self.get(ret.shift()));$.each(ret,function(i,elemId){jQ=jQ.add(self.get(elemId));});return jQ;},$:function(str){return this.jQuery.apply(this,Utils.array(arguments));}};$.each(_events,function(i,ev){var type=/_/.test(ev)?ev.replace(/_/g,''):ev;Galleria[ev.toUpperCase()]='galleria.'+type;});$.extend(Galleria,{IE9:IE===9,IE8:IE===8,IE7:IE===7,IE6:IE===6,IE:IE,WEBKIT:/webkit/.test(NAV),CHROME:/chrome/.test(NAV),SAFARI:/safari/.test(NAV)&&!(/chrome/.test(NAV)),QUIRK:(IE&&doc.compatMode&&doc.compatMode==="BackCompat"),MAC:/mac/.test(navigator.platform.toLowerCase()),OPERA:!!window.opera,IPHONE:/iphone/.test(NAV),IPAD:/ipad/.test(NAV),ANDROID:/android/.test(NAV),TOUCH:('ontouchstart'in doc)});Galleria.addTheme=function(theme){if(!theme.name){Galleria.raise('No theme name specified');}
if(typeof theme.defaults!=='object'){theme.defaults={};}else{theme.defaults=_legacyOptions(theme.defaults);}
var css=false,reg;if(typeof theme.css==='string'){$('link').each(function(i,link){reg=new RegExp(theme.css);if(reg.test(link.href)){css=true;_themeLoad(theme);return false;}});if(!css){$('script').each(function(i,script){reg=new RegExp('galleria\\.'+theme.name.toLowerCase()+'\\.');if(reg.test(script.src)){css=script.src.replace(/[^\/]*$/,'')+theme.css;Utils.addTimer("css",function(){Utils.loadCSS(css,'galleria-theme',function(){_themeLoad(theme);});},1);}});}
if(!css){Galleria.raise('No theme CSS loaded');}}else{_themeLoad(theme);}
return theme;};Galleria.loadTheme=function(src,options){var loaded=false,length=_galleries.length,err=window.setTimeout(function(){Galleria.raise("Theme at "+src+" could not load, check theme path.",true);},5000);Galleria.theme=undef;Utils.loadScript(src,function(){window.clearTimeout(err);if(length){var refreshed=[];$.each(Galleria.get(),function(i,instance){var op=$.extend(instance._original.options,{data_source:instance._data},options);instance.$('container').remove();var g=new Galleria();g._id=instance._id;g.init(instance._original.target,op);refreshed.push(g);});_galleries=refreshed;}});return Galleria;};Galleria.get=function(index){if(!!_instances[index]){return _instances[index];}else if(typeof index!=='number'){return _instances;}else{Galleria.raise('Gallery index '+index+' not found');}};Galleria.configure=function(key,value){var opts={};if(typeof key=='string'&&value){opts[key]=value;key=opts;}else{$.extend(opts,key);}
Galleria.configure.options=opts;$.each(Galleria.get(),function(i,instance){instance.setOptions(opts);});return Galleria;};Galleria.configure.options={};Galleria.on=function(type,callback){if(!type){return;}
Galleria.on.binds.push({type:type,callback:callback||F});$.each(Galleria.get(),function(i,instance){instance.bind(type,callback);});return Galleria;};Galleria.on.binds=[];Galleria.run=function(selector,options){$(selector||'#galleria').galleria(options);return Galleria;};Galleria.addTransition=function(name,fn){_transitions[name]=fn;return Galleria;};Galleria.utils=Utils;Galleria.log=(function(){if('console'in window&&'log'in window.console){return window.console.log;}else{return function(){window.alert(Utils.array(arguments).join(', '));};}}());Galleria.ready=function(fn){$.each(_galleries,function(i,gallery){fn.call(gallery,gallery._options);});Galleria.ready.callbacks.push(fn);return Galleria;};Galleria.ready.callbacks=[];Galleria.raise=function(msg,fatal){var type=fatal?'Fatal error':'Error',self=this,css={color:'#fff',position:'absolute',top:0,left:0,zIndex:100000},echo=function(msg){var html='<div style="padding:4px;margin:0 0 2px;background:#'+
(fatal?'811':'222')+'";>'+
(fatal?'<strong>'+type+': </strong>':'')+
msg+'</div>';$.each(_instances,function(){var cont=this.$('errors'),target=this.$('target');if(!cont.length){target.css('position','relative');cont=this.addElement('errors').appendChild('target','errors').$('errors').css(css);}
cont.append(html);});if(!_instances.length){$('<div>').css($.extend(css,{position:'fixed'})).append(html).appendTo(DOM().body);}};if(DEBUG){echo(msg);if(fatal){throw new Error(type+': '+msg);}}else if(fatal){if(_hasError){return;}
_hasError=true;fatal=false;echo('Gallery could not load.');}};Galleria.version=VERSION;Galleria.requires=function(version,msg){msg=msg||'You need to upgrade Galleria to version '+version+' to use one or more components.';if(Galleria.version<version){Galleria.raise(msg,true);}
return Galleria;};Galleria.Picture=function(id){this.id=id||null;this.image=null;this.container=Utils.create('galleria-image');$(this.container).css({overflow:'hidden',position:'relative'});this.original={width:0,height:0};this.ready=false;this.isIframe=false;};Galleria.Picture.prototype={cache:{},show:function(){Utils.show(this.image);},hide:function(){Utils.moveOut(this.image);},clear:function(){this.image=null;},isCached:function(src){return!!this.cache[src];},preload:function(src){$(new Image()).load((function(src,cache){return function(){cache[src]=src;};}(src,this.cache))).attr('src',src);},load:function(src,size,callback){if(typeof size=='function'){callback=size;size=null;}
if(this.isIframe){var id='if'+new Date().getTime();this.image=$('<iframe>',{src:src,frameborder:0,id:id,allowfullscreen:true,css:{visibility:'hidden'}})[0];$(this.container).find('iframe,img').remove();this.container.appendChild(this.image);$('#'+id).load((function(self,callback){return function(){window.setTimeout(function(){$(self.image).css('visibility','visible');if(typeof callback=='function'){callback.call(self,self);}},10);};}(this,callback)));return this.container;}
this.image=new Image();var i=0,reload=false,resort=false,$container=$(this.container),$image=$(this.image),onload=(function(self,callback,src){return function(){var complete=function(){$(this).unbind('load');self.original=size||{height:this.height,width:this.width};self.container.appendChild(this);self.cache[src]=src;if(typeof callback=='function'){window.setTimeout(function(){callback.call(self,self);},1);}};if((!this.width||!this.height)){window.setTimeout((function(img){return function(){if(img.width&&img.height){complete.call(img);}else{if(!resort){$(new Image()).load(onload).attr('src',img.src);resort=true;}else{Galleria.raise('Could not extract width/height from image: '+img.src+'. Traced measures: width:'+img.width+'px, height: '+img.height+'px.');}}};}(this)),2);}else{complete.call(this);}};}(this,callback,src));$container.find('iframe,img').remove();$image.css('display','block');Utils.hide(this.image);$.each('minWidth minHeight maxWidth maxHeight'.split(' '),function(i,prop){$image.css(prop,(/min/.test(prop)?'0':'none'));});if(this.cache[src]){$image.load(onload).attr('src',src);return this.container;}
$image.load(onload).error(function(){if(!reload){reload=true;window.setTimeout((function(image,src){return function(){image.attr('src',src+'?'+Utils.timestamp());};}($(this),src)),50);}else{if(DUMMY){$(this).attr('src',DUMMY);}else{Galleria.raise('Image not found: '+src);}}}).attr('src',src);return this.container;},scale:function(options){var self=this;options=$.extend({width:0,height:0,min:undef,max:undef,margin:0,complete:F,position:'center',crop:false,canvas:false},options);if(this.isIframe){$(this.image).width(options.width).height(options.height).removeAttr('width').removeAttr('height');$(this.container).width(options.width).height(options.height);options.complete.call(self,self);try{if(this.image.contentWindow){$(this.image.contentWindow).trigger('resize');}}catch(e){}
return this.container;}
if(!this.image){return this.container;}
var width,height,$container=$(self.container),data;Utils.wait({until:function(){width=options.width||$container.width()||Utils.parseValue($container.css('width'));height=options.height||$container.height()||Utils.parseValue($container.css('height'));return width&&height;},success:function(){var newWidth=(width-options.margin*2)/self.original.width,newHeight=(height-options.margin*2)/self.original.height,min=Math.min(newWidth,newHeight),max=Math.max(newWidth,newHeight),cropMap={'true':max,'width':newWidth,'height':newHeight,'false':min,'landscape':self.original.width>self.original.height?max:min,'portrait':self.original.width<self.original.height?max:min},ratio=cropMap[options.crop.toString()],canvasKey='';if(options.max){ratio=Math.min(options.max,ratio);}
if(options.min){ratio=Math.max(options.min,ratio);}
$.each(['width','height'],function(i,m){$(self.image)[m](self[m]=self.image[m]=Math.round(self.original[m]*ratio));});$(self.container).width(width).height(height);if(options.canvas&&_canvas){_canvas.elem.width=self.width;_canvas.elem.height=self.height;canvasKey=self.image.src+':'+self.width+'x'+self.height;self.image.src=_canvas.cache[canvasKey]||(function(key){_canvas.context.drawImage(self.image,0,0,self.original.width*ratio,self.original.height*ratio);try{data=_canvas.elem.toDataURL();_canvas.length+=data.length;_canvas.cache[key]=data;return data;}catch(e){return self.image.src;}}(canvasKey));}
var pos={},mix={},getPosition=function(value,measure,margin){var result=0;if(/\%/.test(value)){var flt=parseInt(value,10)/100,m=self.image[measure]||$(self.image)[measure]();result=Math.ceil(m*-1*flt+margin*flt);}else{result=Utils.parseValue(value);}
return result;},positionMap={'top':{top:0},'left':{left:0},'right':{left:'100%'},'bottom':{top:'100%'}};$.each(options.position.toLowerCase().split(' '),function(i,value){if(value==='center'){value='50%';}
pos[i?'top':'left']=value;});$.each(pos,function(i,value){if(positionMap.hasOwnProperty(value)){$.extend(mix,positionMap[value]);}});pos=pos.top?$.extend(pos,mix):mix;pos=$.extend({top:'50%',left:'50%'},pos);$(self.image).css({position:'absolute',top:getPosition(pos.top,'height',height),left:getPosition(pos.left,'width',width)});self.show();self.ready=true;options.complete.call(self,self);},error:function(){Galleria.raise('Could not scale image: '+self.image.src);},timeout:1000});return this;}};$.extend($.easing,{galleria:function(_,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t+b;}
return c/2*((t-=2)*t*t+2)+b;},galleriaIn:function(_,t,b,c,d){return c*(t/=d)*t+b;},galleriaOut:function(_,t,b,c,d){return-c*(t/=d)*(t-2)+b;}});$.fn.galleria=function(options){var selector=this.selector;if(!$(this).length){$(function(){if($(selector).length){$(selector).galleria(options);}else{Galleria.utils.wait({until:function(){return $(selector).length;},success:function(){$(selector).galleria(options);},error:function(){Galleria.raise('Init failed: Galleria could not find the element "'+selector+'".');},timeout:5000});}});return this;}
return this.each(function(){if(!$.data(this,'galleria')){$.data(this,'galleria',new Galleria().init(this,options));}});};}(jQuery));var fadeSlideShow_descpanel={controls:[['/images/component/image_gallery/x.png',7,7],['/images/component/image_gallery/restore.png',10,11],['/images/component/image_gallery/loading.gif',54,55]],fontStyle:'normal 11px Verdana',slidespeed:200};function fadeSlideShow(settingarg){this.setting=settingarg;settingarg=null;var setting=this.setting;setting.fadeduration=setting.fadeduration?parseInt(setting.fadeduration,10):500;setting.curimage=(setting.persist)?fadeSlideShow.routines.getCookie("gallery-"+setting.wrapperid):0;setting.curimage=setting.curimage||0;setting.currentstep=0;setting.totalsteps=setting.imagearray.length*(setting.displaymode.cycles>0?setting.displaymode.cycles:Infinity);setting.fglayer=0;setting.bglayer=1;setting.oninit=setting.oninit||function(){};setting.onslide=setting.onslide||function(){};if(setting.displaymode.randomize)
setting.imagearray.sort(function(){return 0.5-Math.random();});var preloadimages=[];setting.longestdesc="";for(var i=0;i<setting.imagearray.length;i++){preloadimages[i]=new Image();preloadimages[i].src=setting.imagearray[i][0];if(setting.imagearray[i][3]&&setting.imagearray[i][3].length>setting.longestdesc.length)
setting.longestdesc=setting.imagearray[i][3];}
var closebutt=fadeSlideShow_descpanel.controls[0];setting.closebutton=(setting.descreveal=="always")?'<img class="close" src="'+closebutt[0]+'" style="float:right;cursor:hand;cursor:pointer;width:'+closebutt[1]+'px;height:'+closebutt[2]+'px;margin-left:2px" title="Hide Description" />':'';var slideshow=this;jQuery(document).ready(function($){var setting=slideshow.setting;var fullhtml=fadeSlideShow.routines.getFullHTML(setting.imagearray);setting.$wrapperdiv=$('#'+setting.wrapperid).css({position:'relative',visibility:'visible',background:'black',overflow:'hidden',width:setting.dimensions[0],height:setting.dimensions[1]}).empty();if(setting.$wrapperdiv.length===0){alert("Error: DIV with ID \""+setting.wrapperid+"\" not found on page.");return;}
setting.$gallerylayers=$('<div class="gallerylayer"></div><div class="gallerylayer"></div>').css({position:'absolute',left:0,top:0,width:'100%',height:'100%',background:'black'}).appendTo(setting.$wrapperdiv);var $loadingimg=$('<img src="'+fadeSlideShow_descpanel.controls[2][0]+'" style="position:absolute;width:'+fadeSlideShow_descpanel.controls[2][1]+';height:'+fadeSlideShow_descpanel.controls[2][2]+'" />').css({left:setting.dimensions[0]/2-fadeSlideShow_descpanel.controls[2][1]/2,top:setting.dimensions[1]/2-fadeSlideShow_descpanel.controls[2][2]}).appendTo(setting.$wrapperdiv);var $curimage=setting.$gallerylayers.html(fullhtml).find('img').hide().eq(setting.curimage);if(setting.longestdesc!==""){fadeSlideShow.routines.adddescpanel($,setting);if(setting.descreveal=="always"){setting.$descpanel.css({top:setting.dimensions[1]-setting.panelheight});setting.$descinner.click(function(e){if(e.target.className=="close"){slideshow.showhidedescpanel('hide');}});setting.$restorebutton.click(function(e){slideshow.showhidedescpanel('show');$(this).css({visibility:'hidden'});});}
else{setting.$wrapperdiv.bind('mouseenter',function(){slideshow.showhidedescpanel('show');});setting.$wrapperdiv.bind('mouseleave',function(){slideshow.showhidedescpanel('hide');});}}
setting.$wrapperdiv.bind('mouseenter',function(){setting.ismouseover=true;});setting.$wrapperdiv.bind('mouseleave',function(){setting.ismouseover=false;});if($curimage.get(0).complete){$loadingimg.hide();slideshow.paginateinit($);slideshow.showslide(setting.curimage);}
else{$loadingimg.hide();slideshow.paginateinit($);$curimage.bind('load',function(){slideshow.showslide(setting.curimage);});}
setting.oninit.call(slideshow);$(window).bind('unload',function(){if(slideshow.setting.persist)
fadeSlideShow.routines.setCookie("gallery-"+setting.wrapperid,setting.curimage);jQuery.each(slideshow.setting,function(k){if(slideshow.setting[k]instanceof Array){for(var i=0;i<slideshow.setting[k].length;i++){if(slideshow.setting[k][i].tagName=="DIV")
slideshow.setting[k][i].innerHTML=null;slideshow.setting[k][i]=null;}}});slideshow=slideshow.setting=null;});});}
fadeSlideShow.prototype={navigate:function(keyword){var setting=this.setting;clearTimeout(setting.playtimer);if(setting.displaymode.type=="auto"){setting.displaymode.type="manual";setting.displaymode.wraparound=true;}
if(!isNaN(parseInt(keyword,10))){this.showslide(parseInt(keyword,10));}
else if(/(prev)|(next)/i.test(keyword)){this.showslide(keyword.toLowerCase());}},showslide:function(keyword){var slideshow=this;var setting=slideshow.setting;if(setting.displaymode.type=="auto"&&setting.ismouseover&&setting.currentstep<=setting.totalsteps){setting.playtimer=setTimeout(function(){slideshow.showslide('next');},setting.displaymode.pause);return;}
var totalimages=setting.imagearray.length;var imgindex=(keyword=="next")?(setting.curimage<totalimages-1?setting.curimage+1:0):(keyword=="prev")?(setting.curimage>0?setting.curimage-1:totalimages-1):Math.min(keyword,totalimages-1);var $slideimage=setting.$gallerylayers.eq(setting.bglayer).find('img').hide().eq(imgindex).show();var imgdimensions=[$slideimage.width(),$slideimage.height()];$slideimage.css({marginLeft:(imgdimensions[0]>0&&imgdimensions[0]<setting.dimensions[0])?setting.dimensions[0]/2-imgdimensions[0]/2:0});$slideimage.css({marginTop:(imgdimensions[1]>0&&imgdimensions[1]<setting.dimensions[1])?setting.dimensions[1]/2-imgdimensions[1]/2:0});setting.$gallerylayers.eq(setting.bglayer).css({zIndex:300,opacity:0}).stop().css({opacity:0}).animate({opacity:1},setting.fadeduration,function(){clearTimeout(setting.playtimer);try{setting.onslide.call(slideshow,setting.$gallerylayers.eq(setting.fglayer).get(0),setting.curimage);}catch(e){alert("Fade In Slideshow error: An error has occured somwhere in your code attached to the \"onslide\" event: "+e);}
setting.currentstep+=1;if(setting.displaymode.type=="auto"){if(setting.currentstep<=setting.totalsteps||setting.displaymode.cycles===0)
setting.playtimer=setTimeout(function(){slideshow.showslide('next');},setting.displaymode.pause);}});setting.$gallerylayers.eq(setting.fglayer).css({zIndex:299});setting.fglayer=setting.bglayer;setting.bglayer=(setting.bglayer===0)?1:0;setting.curimage=imgindex;if(setting.$descpanel)
setting.$descpanel.css({visibility:(setting.imagearray[imgindex][3])?'visible':'hidden'});if(setting.imagearray[imgindex][3])
setting.$descinner.empty().html(setting.closebutton+setting.imagearray[imgindex][3]);if(setting.displaymode.type=="manual"&&!setting.displaymode.wraparound){this.paginatecontrol();}
if(setting.$status){setting.$status.html(setting.curimage+1+"/"+totalimages);}
if(setting.$links){jQuery('.fss_links a').each(function(i,a){if(i==setting.curimage){jQuery(a).addClass('active');}else{jQuery(a).removeClass('active')}});}},showhidedescpanel:function(state,showcontrol){var setting=this.setting;var endpoint=(state=="show")?setting.dimensions[1]-setting.panelheight:this.setting.dimensions[1];setting.$descpanel.stop().animate({top:endpoint},fadeSlideShow_descpanel.slidespeed,function(){if(setting.descreveal=="always"&&state=="hide")
setting.$restorebutton.css({visibility:'visible'});});},paginateinit:function($){var slideshow=this;var setting=this.setting;if(setting.togglerid){setting.$togglerdiv=$("#"+setting.togglerid);setting.$prev=setting.$togglerdiv.find('.prev').data('action','prev');setting.$next=setting.$togglerdiv.find('.next').data('action','next');setting.$prev.add(setting.$next).click(function(e){var $target=$(this);slideshow.navigate($target.data('action'));e.preventDefault();});setting.$status=setting.$togglerdiv.find('.status');setting.$links=setting.$togglerdiv.find('.fss_links');if(setting.$links){totalimages=setting.imagearray.length;for(i=1;i<=totalimages;i++){a=jQuery('<a href="#'+i+'">'+i+'</a>');a.click(function(e){n=jQuery(e.delegateTarget).html();slideshow.navigate(parseInt(n)-1);e.preventDefault();});a.appendTo(setting.$links);}}}},paginatecontrol:function(){var setting=this.setting;setting.$prev.css({opacity:(setting.curimage===0)?0.4:1}).data('action',(setting.curimage===0)?'none':'prev');setting.$next.css({opacity:(setting.curimage==setting.imagearray.length-1)?0.4:1}).data('action',(setting.curimage==setting.imagearray.length-1)?'none':'next');if(document.documentMode==8){setting.$prev.find('img:eq(0)').css({opacity:(setting.curimage===0)?0.4:1});setting.$next.find('img:eq(0)').css({opacity:(setting.curimage==setting.imagearray.length-1)?0.4:1});}}};fadeSlideShow.routines={getSlideHTML:function(imgelement){var layerHTML=(imgelement[1])?'<a href="'+imgelement[1]+'" target="'+imgelement[2]+'">\n':'';layerHTML+='<img src="'+imgelement[0]+'" style="border-width:0;" />\n';layerHTML+=(imgelement[1])?'</a>\n':'';return layerHTML;},getFullHTML:function(imagearray){var preloadhtml='';for(var i=0;i<imagearray.length;i++)
preloadhtml+=this.getSlideHTML(imagearray[i]);return preloadhtml;},adddescpanel:function($,setting){setting.$descpanel=$('<div class="fadeslidedescdiv"></div>').css({position:'absolute',visibility:'hidden',width:'100%',left:0,top:setting.dimensions[1],font:fadeSlideShow_descpanel.fontStyle,zIndex:'301'}).appendTo(setting.$wrapperdiv);$('<div class="descpanelbg"></div><div class="descpanelfg"></div>').css({position:'absolute',left:0,top:0,width:setting.$descpanel.width()-8,padding:'4px'}).eq(0).css({background:'black',opacity:0.7}).end().eq(1).css({color:'white'}).html(setting.closebutton+setting.longestdesc).end().appendTo(setting.$descpanel);setting.$descinner=setting.$descpanel.find('div.descpanelfg');setting.panelheight=setting.$descinner.outerHeight();setting.$descpanel.css({height:setting.panelheight}).find('div').css({height:'100%'});if(setting.descreveal=="always"){setting.$restorebutton=$('<img class="restore" title="Restore Description" src="'+fadeSlideShow_descpanel.controls[1][0]+'" style="position:absolute;visibility:hidden;right:0;bottom:0;z-index:1002;width:'+fadeSlideShow_descpanel.controls[1][1]+'px;height:'+fadeSlideShow_descpanel.controls[1][2]+'px;cursor:pointer;cursor:hand" />').appendTo(setting.$wrapperdiv);}},getCookie:function(Name){var re=new RegExp(Name+"=[^;]+","i");if(document.cookie.match(re))
return document.cookie.match(re)[0].split("=")[1];return null;},setCookie:function(name,value){document.cookie=name+"="+value+";path=/";}};(function($,document,undefined){var pluses=/\+/g;function raw(s){return s;}
function decoded(s){return decodeURIComponent(s.replace(pluses,' '));}
var config=$.cookie=function(key,value,options){if(value!==undefined){options=$.extend({},config.defaults,options);if(value===null){options.expires=-1;}
if(typeof options.expires==='number'){var days=options.expires,t=options.expires=new Date();t.setDate(t.getDate()+days);}
value=config.json?JSON.stringify(value):String(value);return(document.cookie=[encodeURIComponent(key),'=',config.raw?value:encodeURIComponent(value),options.expires?'; expires='+options.expires.toUTCString():'',options.path?'; path='+options.path:'',options.domain?'; domain='+options.domain:'',options.secure?'; secure':''].join(''));}
var decode=config.raw?raw:decoded;var cookies=document.cookie.split('; ');for(var i=0,l=cookies.length;i<l;i++){var parts=cookies[i].split('=');if(decode(parts.shift())===key){var cookie=decode(parts.join('='));return config.json?JSON.parse(cookie):cookie;}}
return null;};config.defaults={};$.removeCookie=function(key,options){if($.cookie(key)!==null){$.cookie(key,null,options);return true;}
return false;};})(jQuery,document);;(function($){$.fn.superfish=function(op){var sf=$.fn.superfish,c=sf.c,$arrow=$('<span class="'+c.arrowClass+' arrow_down"> &#x25BC;</span>'),over=function(){var $this=$(this),o=getOptions($this);clearTimeout(o.sfTimer);$this.showSuperfishUl().siblings().hideSuperfishUl();},out=function(e){var $this=$(this),o=getOptions($this);if(e.type==='click'||sf.ios){$.proxy(close,$this,o)();}
else{clearTimeout(o.sfTimer);o.sfTimer=setTimeout($.proxy(close,$this,o),o.delay);}},close=function(o){o.retainPath=($.inArray(this[0],o.$path)>-1);this.hideSuperfishUl();if(!this.parents('.'+o.hoverClass).length){o.onIdle.call(getMenu(this));if(o.$path.length){$.proxy(over,o.$path)();}}},getMenu=function($el){return $el.closest('.'+c.menuClass);},getOptions=function($el){return getMenu($el).data('sf-options');},applyTouchAction=function($menu){$menu.css('ms-touch-action','none');},applyHandlers=function($menu,o){var targets='li:has(ul)';if(!o.useClick){if($.fn.hoverIntent&&!o.disableHI){$menu.hoverIntent(over,out,targets);}
else{$menu.on('mouseenter',targets,over).on('mouseleave',targets,out);}}
var touchstart='MSPointerDown';if(!sf.ios){touchstart+=' touchstart';}
if(sf.wp7){touchstart+=' mousedown';}
$menu.on('focusin','li',over).on('focusout','li',out).on('click','a',o,clickHandler).on(touchstart,'a',touchHandler);},touchHandler=function(e){var $this=$(this),$ul=$this.siblings('ul');if($ul.length>0&&$ul.is(':hidden')){$this.data('follow',false);if(e.type==='MSPointerDown'){$this.trigger('focus');return false;}}},clickHandler=function(e){var $a=$(this),o=e.data,$submenu=$a.siblings('ul'),follow=($a.data('follow')===false)?false:true;if($submenu.length&&(o.useClick||!follow)){e.preventDefaolt();if($submenu.is(':hidden')){$.proxy(over,$a.parent('li'))();}
else if(o.useClick&&follow){$.proxy(out,$a.parent('li'),e)();}}},setPathToCurrent=function($menu,o){return $menu.find('li.'+o.pathClass).slice(0,o.pathLevels).addClass(o.hoverClass+' '+c.bcClass).filter(function(){return($(this).children('ul').hide().show().length);}).removeClass(o.pathClass);},addArrows=function($li,o){if(o.autoArrows){$li.children('a').each(function(){addArrow($(this));});}},addArrow=function($a){$a.addClass(c.anchorClass).append($arrow.clone());};sf.getOptions=getOptions;return this.addClass(c.menuClass).each(function(){var $this=$(this),o=$.extend({},sf.defaults,op),$liHasUl=$this.find('li:has(ul)');o.$path=setPathToCurrent($this,o);$this.data('sf-options',o);addArrows($liHasUl,o);applyTouchAction($this);applyHandlers($this,o);$liHasUl.not('.'+c.bcClass).hideSuperfishUl(true);o.onInit.call(this);});};var sf=$.fn.superfish;sf.o=[];sf.op={};sf.c={bcClass:'sf-breadcrumb',menuClass:'sf-js-enabled',anchorClass:'sf-with-ul',arrowClass:'sf-sub-indicator'};sf.defaults={hoverClass:'sfHover',appendTo:null,pathClass:'overrideThisToUse',pathLevels:1,delay:800,animation:{opacity:'show'},animationOut:{opacity:'hide'},speed:'normal',speedOut:'fast',autoArrows:true,disableHI:false,useClick:false,onInit:$.noop,onBeforeShow:$.noop,onShow:$.noop,onBeforeHide:$.noop,onHide:$.noop,onIdle:$.noop};sf.ios=/iPhone|iPad|iPod/i.test(navigator.userAgent);sf.wp7=(function(){var style=document.documentElement.style;return('behavior'in style&&'fill'in style&&/iemobile/i.test(navigator.userAgent));})();$.fn.extend({hideSuperfishUl:function(instant){if(this.length){var $this=this,o=sf.getOptions($this),not=(o.retainPath===true)?o.$path:'',$ul=$this.find('li.'+o.hoverClass).add(this).not(not).removeClass(o.hoverClass).children('ul'),speed=o.speedOut;if(instant){$ul.show();speed=0;}
o.retainPath=false;o.onBeforeHide.call($ul);$ul.stop(true,true).animate(o.animationOut,speed,function(){var $this=$(this);o.onHide.call($this);if(o.useClick){$this.siblings('a').data('follow',false);}});}
return this;},showSuperfishUl:function(){var o=sf.getOptions(this),$this=this.addClass(o.hoverClass),$ul=$this.children('ul');o.onBeforeShow.call($ul);$ul.stop(true,true).animate(o.animation,o.speed,function(){o.onShow.call($ul);$this.children('a').data('follow',true);});return this;}});if(sf.ios){$(window).load(function(){$('body').children().on('click',$.noop);});}})(jQuery);(function($){$.fn.subnav=function(){this.superfish();this.each(function(){var $ul=$(this).addClass('sf-menu'),$items=$('> li',this);if(!$items.length)return;$items.each(function(i,item){var $item=$(item);if($item.css('display')=='inline')$item.css('display','inline-block');});var $first=$($items[0]),$next=$($items[1]);if($next.length&&Math.abs($first.offset()['top']-$next.offset()['top'])>$first.height()/2){$ul.addClass('sf-vertical');var center=$(window).width()/2;if($ul.offset()['left']>center){$ul.addClass('sf-right');}}
function luminosity(element){var color=$(element).css('color'),colors=(color[0]=='#')?hexToRgb(color):color.replace("rgb(",'').replace(")",'').replace(/\s+/g,'').split(',');return(0.2126*colors[0]/255)+(0.7152*colors[1]/255)+(0.0722*colors[2]/255);}
var avg_luminosity=0;$items.each(function(){avg_luminosity+=luminosity($(this).find('a'));});avg_luminosity/=$items.length;$('ul',$ul).addClass((avg_luminosity>0.6)?'sf-dark':'sf-light');$ul.parents().add($ul).each(function(index,p){var $p=$(p);if($p.css('overflow')=='hidden'){$p.css('overflow','visible').addClass('aclearfix');}});});};function hexToRgb(hex){var shorthandRegex=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;hex=hex.replace(shorthandRegex,function(m,r,g,b){return r+r+g+g+b+b;});var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return result?[parseInt(result[1],16),parseInt(result[2],16),parseInt(result[3],16)]:null;}})(jQuery);